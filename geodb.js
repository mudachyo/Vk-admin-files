!function(e){function t(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},t.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=501)}({196:function(e,t,n){"use strict";function i(){return nav.strLoc}function o(e){var t={0:nav.objLoc[0],act:nav.objLoc.act};nav.setLoc(extend(t,e))}function a(e){return nav.objLoc[e]}function r(){return a("act")}function c(e){var t=window.open(e,"_blank");t.focus()}function s(){var e=new MessageBox;e.setOptions({title:!1,hideButtons:!0}).show(),hide(boxLayerBG),hide(e.bodyNode),show(boxLoader),boxRefreshCoords(boxLoader)}function d(){curBox&&curBox()&&curBox().hide()}function l(){curBox().hide()}function g(e,t,n){window.radioBtns[e]={val:n,els:Array.prototype.slice.apply(geByClass("radiobtn",geByClass1(t)))}}function u(e){return e.ctrlKey||e.metaKey&&browser.mac}n.r(t),n.d(t,"PHP_SECOND",function(){return _}),n.d(t,"PHP_MINUTE",function(){return m}),n.d(t,"PHP_HOUR",function(){return v}),n.d(t,"PHP_DAY",function(){return p}),n.d(t,"PHP_WEEK",function(){return h}),n.d(t,"PHP_MONTH",function(){return f}),n.d(t,"PHP_YEAR",function(){return y}),n.d(t,"MILLISECONDS_MULTIPLIER",function(){return b}),n.d(t,"SECOND",function(){return L}),n.d(t,"MINUTE",function(){return w}),n.d(t,"HOUR",function(){return E}),n.d(t,"DAY",function(){return C}),n.d(t,"WEEK",function(){return x}),n.d(t,"MONTH",function(){return B}),n.d(t,"YEAR",function(){return T}),n.d(t,"TARGET_BLANK",function(){return M}),n.d(t,"EVENT_MOUSEDOWN",function(){return S}),n.d(t,"EVENT_KEYDOWN",function(){return k}),n.d(t,"EVENT_SCROLL",function(){return D}),n.d(t,"EVENT_CLICK",function(){return F}),n.d(t,"getCurrentUrl",function(){return i}),n.d(t,"updateUrl",function(){return o}),n.d(t,"getUrlParam",function(){return a}),n.d(t,"getAct",function(){return r}),n.d(t,"openInNewTab",function(){return c}),n.d(t,"showLoading",function(){return s}),n.d(t,"hideLoading",function(){return d}),n.d(t,"hideCurrentBox",function(){return l}),n.d(t,"initRadioButtons",function(){return g}),n.d(t,"isSpecialKeyPressed",function(){return u});var _=1,m=60,v=3600,p=86400,h=604800,f=2592e3,y=31536e3,b=1e3,L=_*b,w=m*b,E=v*b,C=p*b,x=p*b,B=f*b,T=y*b,M="_blank",S="mousedown",k="keydown",D="scroll",F="click"},2:function(e,t,n){"use strict";n.r(t),n.d(t,"FacEdit",function(){return i});var i={progressLine:'<div style="padding:18px 0px 19px 0px;text-align: center"><img valign="middle" src="/images/progress7.gif"></div>',facName:function(e){return e.getElementsByTagName("a")[0].innerHTML},getFacName:function(e){return val("name_"+e.id)},getNameId:function(e){return"name_fac"+e},getNativeNameId:function(e){return"fac_native_name"+e},getEditingNameById:function(e){return val("name"+e)},getEditingNativeNameById:function(e){return val("native_name"+e)},facOpFailed:function(e){i.msg(e,getLang("global_unknown_error"))},showCreateFacBox:function(e,t){var n=new MessageBox({title:getLang("edit_fac_addingfac"),width:500}),i='<div id="auxFuncs">';i+="<div id=\"inputDiv\"><div class='ed_row_label'>"+getLang("edit_fac_name")+"</div><textarea onKeyPress='onCtrlEnter(event, cur.onSaveClick);' onchange='Edit.autoCorrect(6);' class='text dark ed_textarea' id='name'></textarea><div id='create_faculty_msg'></div></div>",i+=Edit.genCorrectionControls(6,"name",t),i+="</div>",n.content(i),Edit.loadAutocorrects(6);var o;cur.onSaveClick=function(){var t=val("name"),n=Edit.countRealLen(t,!0);hide("create_faculty_msg"),n>9e3?(ge("create_faculty_msg").innerHTML=getLang("text_exceeds_symbol_limit",n-9e3),show("create_faculty_msg")):""!=t?(lockButton(o),ge("addActHidden").value="doAddItem",ge("addItemHidden").value="Faculty",ge("addNameHidden").value=t,ge("addParentIDHidden").value=e,ge("addFormHidden").submit()):notaBene("name")},n.addButton(getLang("global_cancel"),null,"no"),o=n.addButton(getLang("edit_add"),cur.onSaveClick,"ok",!0),n.show(),elfocus("name")},deleteFaculties:function(){var e=Edit.getSelectedItems(i.facName),t=Edit.getMessageBox(getLang("edit_deleting_facs"),450,getLang("global_delete"),getLang("global_cancel"),function(){var e=Edit.getIdList(r.selectedItems());e&&(ajax.post("/editdb",{act:"a_real_del_fac",fac:e},{onDone:function(e){for(var n in e)ge("actions_fac"+n).innerHTML="",ge("msg_fac"+n).innerHTML=e[n].html;t.hide()}}),t.content(i.progressLine))},"enter");t.content(getLang("edit_facs_delete")+'<div id="delFacList"></div><div id="delCount"></div>').show();var n=Edit.getAllItems(i.facName),o=Edit.getDefaultListParams(e,n),a=function(){var e=Edit.getIdList(r.selectedItems());ajax.post("/editdb",{act:"a_count_fac",nolink:1,fac:e},{onDone:function(e){ge("delCount").innerHTML=e}})};o.onTagAdd=a,o.onTagRemove=a;var r=new Autocomplete(ge("delFacList"),n,o);a()},mergeTo1:function(e){var t=Edit.getSelectedItems(i.facName),n=Edit.getMessageBox("Склейка факультетов",450,getLang("edit_merge"),getLang("global_cancel"),function(){var e=Edit.getIdList(r.selectedItems()),t=c.val();e&&t&&(ajax.post("/editdb",{act:"a_merge_fac",fac:e,main_fac:t},{onDone:function(e){for(var t in e)ge("actions_fac"+t).innerHTML="",ge("msg_fac"+t).innerHTML=e[t].html;n.hide()}}),n.content(i.progressLine))},"enter");n.content('<div style="padding:10px 0 5px">Приклеить факультеты:</div><div id="mergeFacList"></div><div style="padding:10px 0 5px">к факультету:</div><div id="mergeFac" style="margin:5px 0 10px"></div>').show();var o=Edit.getAllItems(i.facName),a=Edit.getDefaultListParams(t,o),r=new Autocomplete(ge("mergeFacList"),o,a),c=new Dropdown(ge("mergeFac"),o,a);c.val(e)},setMergeLink:function(e,t){each(cur.pageItems,function(t,n){ge("merge_"+n)&&(n!="fac"+cur.main_fac_id?(ge(n).style.backgroundColor="#FFFFFF",ge("merge_with_"+n).innerHTML=e):(ge(n).style.backgroundColor="#E2E8ED",ge("merge_with_"+n).innerHTML="Склеить"))})},mergeTo:function(e){if(e){var t=ge("fac"+e);if(e==cur.main_fac_id)return cur.main_fac_id=0,void i.setMergeLink("Склеить","Клеить к нему");cur.main_fac_id=e,i.setMergeLink("Склеить с "+i.facName(t).substr(0,15)+"...","Не клеить")}},mergeWith:function(e){cur.main_fac_id&&ajax.post("/editdb",{act:"a_merge_fac",fac:e,main_fac:cur.main_fac_id},{onDone:function(e){for(var t in e)ge("actions_fac"+t).innerHTML="",ge("msg_fac"+t).innerHTML=e[t].html}})},setMergeObject:function(e){cur.mergeObject&&cur.mergeObject>0&&(ge("fac"+cur.mergeObject).style.backgroundColor="#FFFFFF",ge("fac"+cur.mergeObject).getElementsByTagName("a")[0].style.color="#2B587A",i.msg(cur.mergeObject,"")),e!=cur.mergeObject?(ge("fac"+e).style.backgroundColor="#E2E8ED",ge("fac"+e).getElementsByTagName("a")[0].style.color="#36638E",i.msg(e,getLang("edit_fac_youselected"),"report"),cur.mergeObject=e):cur.mergeObject=0},mergeFac:function(e){cur.mergeObject?(ajax.post("/editdb",{act:"a_merge_fac",fac:e,main_fac:cur.mergeObject},{onDone:i.facMergeSuccess.pbind(e),onFail:i.facOpFailed.pbind(e)}),i.msg(e,i.progressLine)):i.msg(e,getLang("edit_fac_youshould"),"reportGrey")},facMergeSuccess:function(e,t){t[e]&&(t=t[e]),t&&t.html&&(2==t.code&&setTimeout(function(){ge("fac"+e).style.opacity=.3},1e3),ge("fac"+e).getElementsByTagName("span")[0].innerHTML="",i.msg(e,t.html))},moveFacs:function(){var e=Edit.getSelectedItems(i.getFacName);e.length||(e=Edit.getAllItems(i.getFacName));var t=Edit.getMessageBox(getLang("edit_move_facs"),450,getLang("edit_move"),getLang("global_cancel"),function(){var e=ge("uni2").value,n=Edit.getIdList(a.selectedItems());n&&e&&(ajax.post("/editdb",{act:"a_move_facs",fac_ids:n,uni_id:e},{onDone:function(e){for(var n in e)ge("actions_fac"+n).innerHTML="",ge("msg_fac"+n).innerHTML=e[n].html;t.hide()}}),t.content(i.progressLine))},"enter");t.content('<div id="moveFacList"></div><div id="uniList" style="margin-top:10px;">'+i.progressLine+"</div>").show();var n=Edit.getAllItems(i.getFacName),o=Edit.getDefaultListParams(e,n),a=new Autocomplete(ge("moveFacList"),n,o),r=e[0][0];ajax.post("/editdb",{act:"a_get_unis",fac:r},{onDone:function(e){ge("uniList").innerHTML=e;var t=new UniversitySelect(ge("uni2"),ge("uni2_row"),{width:200,city:cur.currentCity[0],university:cur.currentUni}),n=new CitySelect(ge("city2"),ge("city2_row"),{width:200,country:cur.currentCountry[0],city:cur.currentCity,universitySelect:t});new CountrySelect(ge("country2"),ge("country2_row"),{width:200,country:cur.currentCountry,citySelect:n})}})},showMoveFacBox:function(e){var t=new MessageBox({title:ge("fac"+e).getElementsByTagName("a")[0].innerHTML,width:500});ajax.post("/editdb",{act:"a_get_unis",fac:e},{onDone:function(e){t.content(e);var n=new UniversitySelect(ge("uni2"),ge("uni2_row"),{width:200,city:cur.currentCity[0],university:cur.currentUni}),i=new CitySelect(ge("city2"),ge("city2_row"),{width:200,country:cur.currentCountry[0],city:cur.currentCity,universitySelect:n});new CountrySelect(ge("country2"),ge("country2_row"),{width:200,country:cur.currentCountry,citySelect:i})},onFail:i.facOpFailed.pbind(e)}),t.content('<div style="text-align: center"><img valign="middle" src="/images/progress7.gif"></div>').show();var n;cur.onMoveClick=function(){val("uni2")>0&&ajax.post("/editdb",{act:"a_move_fac",uni:val("uni2"),fac:e},{showProgress:lockButton.pbind(n),hideProgress:unlockButton.pbind(n),onDone:i.facMoved.pbind(e),onFail:i.facOpFailed.pbind(e)})},t.addButton(getLang("global_cancel"),null,"no"),n=t.addButton(getLang("edit_move"),cur.onMoveClick,"",!0)},facMoved:function(e,t,n){Edit.hideBox(),2==t&&setTimeout(function(){ge("fac"+e).style.opacity=.3},1e3),i.msg(e,n)},showEditFacsBox:function(){var e=Edit.getSelectedItems(i.facName),t=val("autocorr_num"),n=new MessageBox({title:getLang("edit_editing_fac_mul"),width:700}),o='<div id="auxFuncs">';o+=e.length>8?'<div id="inputDiv" style="overflow: auto; height: 400px">':'<div id="inputDiv">',o+='<table class="ed_form_table ed_form_table_hor">';for(var a,r,c="",a=0;a<e.length;++a)r=parseInt(e[a]),c+=cur.editFacRowBoxHtml.replace(/%fac_id%/g,r);if(c.length){o+=c+"</table></div>",o+=Edit.genCorrectionControlsMul(6,"FacEdit.facName",t),o+="</div>",n.content(o);for(var a=0;a<e.length;++a)r=parseInt(e[a]),val("name"+r,val(i.getNameId(r))).replace("&amp;","&"),val("native_name"+r,val(i.getNativeNameId(r))).replace("&amp;","&");Edit.loadAutocorrects(6);var s;cur.onSaveClick=function(){for(var t={act:"a_rename_facs"},n=0;n<e.length;++n){var o=parseInt(e[n]),a=i.getEditingNameById(o),r=i.getEditingNativeNameById(o);if(!a.length)return void notaBene(i.getNameId(o));t["fac"+n+"id"]=o,t["fac"+n+"name"]=a,t["fac"+n+"native_name"]=r}ajax.post("/editdb",t,{showProgress:lockButton.pbind(s),hideProgress:unlockButton.pbind(s),onDone:function(t){for(var n=0;n<e.length;++n){var o=parseInt(e[n]);ge("msg_fac"+o).innerHTML=t[o].html,t[o].name&&(ge(i.getNameId(o)).innerHTML=t[o].name),"native_name"in t[o]&&(ge(i.getNativeNameId(o)).value=t[o].native_name)}Edit.hideBox()},onFail:function(){for(var t=0;t<e.length;++t){var n=parseInt(e[t]);ge("msg_fac"+n).innerHTML=getLang("global_unknown_error")}}})},n.addButton(getLang("global_cancel"),null,"no"),s=n.addButton(getLang("edit_editsave"),cur.onSaveClick,"ok",!0),n.show()}},openNonEmptyChairsWindows:function(){var e=Edit.getSelectedItems(function(){return""});if(0==e.length){e=[];for(var t=0;t<cur.pageItems.length;t++)e.push([parseInt(cur.pageItems[t].replace("fac","")),""])}for(var t=0;t<e.length;++t){var n=val("chairs_count"+e[t][0]);n>0&&window.open("http://"+location.hostname+"/editdb?act=f&f="+e[t][0])}},showEditFacBox:function(e){var t=val("autocorr_num"),n=new MessageBox({title:val(i.getNameId(e)),width:500}),o=val(i.getNameId(e)).replace("&amp;","&"),a=val(i.getNativeNameId(e)).replace("&amp;","&"),r='<div id="auxFuncs">';r+=i.createEditBox(e,o,a),r+=Edit.genCorrectionControls(6,"name"+e+",native_name"+e,t),n.content(r),val(geByClass1("_name","ed_fac_form"),o),val(geByClass1("_native_name","ed_fac_form"),a),Edit.loadAutocorrects(6);var c;cur.onSaveClick=function(){var t=geByClass1("_name","ed_fac_form");if(val(t).length>0){var n={act:"a_edit_fac",fac:e,name:val(geByClass1("_name","ed_fac_form")),native_name:val(geByClass1("_native_name","ed_fac_form"))};ajax.post("/editdb",n,{showProgress:lockButton.pbind(c),hideProgress:unlockButton.pbind(c),onDone:function(t){val(i.getNameId(e),n.name),val(i.getNativeNameId(e),n.native_name),Edit.hideBox(),i.msg(e,t)},onFail:i.facOpFailed.pbind(e)})}else notaBene(t)},n.addButton(getLang("global_cancel"),null,"no"),c=n.addButton(getLang("edit_editsave"),cur.onSaveClick,"ok",!0),n.show(),elfocus("name"+e,0)},createEditBox:function(e,t,n){return'<div id="ed_fac_form"><div class="ed_row_label">'+getLang("edit_fac_name")+'</div><input type="text" id="name'+e+'" onkeypress="Edit.onEnter(event, cur.onSaveClick);" onchange="Edit.autoCorrect(6, this);" class="ed_row_input text dark _name" value="'+t+'"/> <div class="ed_row_label">'+getLang("edit_city_natname")+'</div><input type="text" id="native_name'+e+'" onkeypress="Edit.onEnter(event, cur.onSaveClick);" class="ed_row_input text dark _native_name" value="'+n+'" /></div>'},restoreMergedFac:function(e){ajax.post("/editdb",{act:"a_restore_merged_fac",fac:e},{onDone:function(e){for(var t in e)ge("msg_fac"+t)&&(ge("msg_fac"+t).innerHTML=e[t].html);setTimeout(function(){for(var t in e)ge("fac"+t)&&(ge("fac"+t).style.opacity=1)},1e3)},onFail:i.facOpFailed.pbind(e)})},delFac:function(e){ajax.post("/editdb",{act:"a_del_fac",fac:e},{onDone:i.facDelSuccess.pbind(e),onFail:i.facOpFailed.pbind(e)})},facDelSuccess:function(e,t){t[e]&&(t=t[e]),t&&void 0!==t.code&&(1==t.code?i.showDelFacBox(e,t.html):(setTimeout(function(){ge("fac"+e).style.opacity=.3},1e3),i.msg(e,t.html),ge("actions_fac"+e).innerHTML=""))},showDelFacBox:function(e,t){var n=Edit.getMessageBox(ge(i.getNameId(e)).innerHTML,300,getLang("global_delete"),getLang("global_cancel"),function(){ajax.post("/editdb",{act:"a_real_del_fac",fac:e},{onDone:i.facDelSuccess.pbind(e),onFail:i.facOpFailed.pbind(e)}),n.content(i.progressLine),n.hide()},"enter");return n.content("<div style='padding:5px 0px;'>"+getLang("edit_fac_suredelete")+t+"</div>").show(),!1},restoreFac:function(e){ajax.post("/editdb",{act:"a_restore_fac",fac:e},{onDone:function(t,n){t&&(ge("msg_fac"+e).innerHTML=n,setTimeout(function(){ge("fac"+e).style.opacity=1},1e3))},onFail:i.facOpFailed.pbind(e)})},countFac:function(e){ajax.post("/editdb",{act:"a_count_fac",fac:e},{onDone:function(t){i.msg(e,t)},onFail:i.facOpFailed.pbind(e)}),i.msg(e,i.progressLine)},closeFac:function(e){ajax.post("/editdb",{act:"a_close_fac",fac:e},{onDone:function(t){t[e]&&(t=t[e]);var n="";t&&t.html&&(ge("openclose"+e).href="javascript:FacEdit.openFac("+e+");",val("openclose"+e,getLang("edit_open")),n=t.html),i.msg(e,n)},onFail:i.facOpFailed.pbind(e)}),i.msg(e,i.progressLine)},openFac:function(e){ajax.post("/editdb",{act:"a_open_fac",fac:e},{onDone:function(t){t[e]&&(t=t[e]),t&&t.html&&(ge("openclose"+e).href="javascript:FacEdit.closeFac("+e+");",val("openclose"+e,getLang("edit_close")),i.msg(e,t.html))},onFail:i.facOpFailed.pbind(e)}),i.msg(e,i.progressLine)},closeFaculties:function(){var e=Edit.getSelectedItems(i.facName),t=Edit.getMessageBox(getLang("edit_closing_facs"),450,getLang("global_close"),getLang("global_cancel"),function(){var e=Edit.getIdList(a.selectedItems());e&&(ajax.post("/editdb",{act:"a_close_fac",fac:e},{onDone:function(e){for(var n in e)ge("openclose"+n).href="javascript: FacEdit.openFac("+n+");",ge("openclose"+n).innerHTML=getLang("edit_open"),ge("msg_fac"+n).innerHTML=e[n].html;t.hide()}}),t.content(i.progressLine))},"enter");t.content(getLang("edit_facs_close")+'<div id="closeFacList"></div>').show();var n=Edit.getAllItems(i.facName),o=Edit.getDefaultListParams(e,n),a=new Autocomplete(ge("closeFacList"),n,o)},styleBoldName:function(e){addClass("fac"+e,"ed_item_bolded")},styleUnboldName:function(e){removeClass("fac"+e,"ed_item_bolded")},bold:function(e){ajax.post("/editdb",{act:"a_bold_fac",fac_id:e},{onDone:i.styleBoldName.pbind(e)})},unbold:function(e){ajax.post("/editdb",{act:"a_unbold_fac",fac_id:e},{onDone:i.styleUnboldName.pbind(e)})},boldAll:function(e,t){ajax.post("/editdb",{act:"a_bold_facs",uni_id:e},{onDone:function(n,o){if(2==n){for(var a=0;a<o.length;++a)i.styleBoldName(o[a]);removeEvent(t,"click"),t.onclick="",addEvent(t,"click",function(){return i.unboldAll(e,t),!1}),t.innerHTML=getLang("edit_unbold_all_facs")}}})},unboldAll:function(e,t){ajax.post("/editdb",{act:"a_unbold_facs",uni_id:e},{onDone:function(n,o){if(2==n){for(var a=0;a<o.length;++a)i.styleUnboldName(o[a]);removeEvent(t,"click"),t.onclick="",addEvent(t,"click",function(){return i.boldAll(e,t),!1}),t.innerHTML=getLang("edit_bold_all_facs")}}})},msg:function(e,t,n){t?(n&&(t='<div class="'+n+'">'+t+"</div>"),val("msg_fac"+e,t)):val("msg_fac"+e,"")}}},213:function(e,t,n){"use strict";n.r(t);var i=n(56),o=n(458),a=n(409),r=n(471),c=n(2),s=n(320),d=n(629),l=n(277),g=n(347),u=n(341),_=n(521),m=n(492);window.Edit=i.Edit,window.ChairEdit=o.ChairEdit,window.CityEdit=a.CityEdit,window.DistrictEdit=r.DistrictEdit,window.FacEdit=c.FacEdit,window.SchEdit=s.SchEdit,window.StationEdit=d.StationEdit,window.StreetEdit=l.StreetEdit,window.UniEdit=g.UniEdit,window.Admins=u.Admins,window.initSettings=_.init,window.RequestsFunctions=m.RequestsFunctions,window.initRequests=m.init;try{stManager.done(jsc("internal/geodb.js"))}catch(v){console.log(v)}},277:function(e,t,n){"use strict";n.r(t),n.d(t,"StreetEdit",function(){return i});var i={progressLine:'<div style="padding:18px 0px 19px 0px;text-align: center"><img valign="middle" src="/images/progress7.gif"></div>',msg:function(e,t,n){t?(n&&(t='<div class="'+n+'">'+t+"</div>"),val("msg_street"+e,t)):val("msg_street"+e,"")},streetName:function(e){return ge("name_"+e.id).innerHTML.replace(/<[^>]*>/g," ")},opFailed:function(e){ge("street"+e).getElementsByTagName("div")[0].innerHTML=getLang("global_unknown_error")},showCreateStreetBox:function(e,t){var n=new MessageBox({title:getLang("edit_addingstreet"),width:500}),i='<div id="auxFuncs">';i+="<div id=\"inputDiv\"><div class='ed_row_label'>"+getLang("edit_street_name")+"</div><textarea onKeyPress='onCtrlEnter(event, cur.onSaveClick);' onchange='Edit.autoCorrect(4);' class='text dark ed_textarea' id='name'></textarea><div id='create_street_msg'></div></div>",i+=Edit.genCorrectionControls(4,"name",t),i+="</div>",Edit.loadAutocorrects(4),n.content(i);var o;cur.onSaveClick=function(){var t=ge("name").value,n=Edit.countRealLen(t,!0);hide("create_street_msg"),n>9e3?(ge("create_street_msg").innerHTML=getLang("text_exceeds_symbol_limit",n-9e3),show("create_street_msg")):t.length>0?(ge("addActHidden").value="doCreateStreet",ge("addNameHidden").value=t,ge("addCityHidden").value=e,ge("addFormHidden").submit(),lockButton(o)):notaBene("name")},n.addButton(getLang("global_cancel"),null,"no"),o=n.addButton(getLang("edit_add"),cur.onSaveClick,"",!0),n.show(),elfocus("name")},setMergeObject:function(e){cur.mergeObject>0&&ge("street"+cur.mergeObject)&&(ge("street"+cur.mergeObject).style.backgroundColor="#FFFFFF",ge("street"+cur.mergeObject).getElementsByTagName("a")[0].style.color="#2B587A",i.msg(cur.mergeObject,"")),e!=cur.mergeObject?(ge("street"+e).style.backgroundColor="#E2E8ED",ge("street"+e).getElementsByTagName("a")[0].style.color="#36638E",i.msg(e,getLang("edit_street_youselected"),"report"),cur.mergeObject=e):cur.mergeObject=0},mergeStreet:function(e){cur.mergeObject?(ajax.post("/editdb",{act:"a_merge_street",street:e,main_street:cur.mergeObject},{onDone:function(t,n){n&&(2==t&&setTimeout(function(){ge("street"+e).style.opacity=.3},1e3),ge("street"+e).getElementsByTagName("span")[0].style.display="none",ge("msg_street"+e).innerHTML=n)},onFail:i.opFailed.pbind(e)}),ge("msg_street"+e).innerHTML=i.progressLine):ge("msg_street"+e).innerHTML="<div class='reportGrey'>"+getLang("edit_street_youshould")+"</div>"},unMergeStreet:function(e,t){ajax.post("/editdb",{act:"a_unmerge_street",street:e,new_street:t},{onDone:function(t,n){2==t&&setTimeout(function(){ge("street"+e).style.opacity=1},1e3),ge("street"+e).getElementsByTagName("span")[0].style.display="inline",ge("msg_street"+e).innerHTML=n},onFail:i.opFailed.pbind(e)}),ge("msg_street"+e).innerHTML=i.progressLine},showEditStreetBox:function(e){var t=val("autocorr_num"),n=new MessageBox({title:ge("street"+e).getElementsByTagName("a")[0].innerHTML,width:500}),o='<div id="auxFuncs">';o+="<div id=\"inputDiv\"><div class='ed_form_label'>"+getLang("edit_street_name")+"</div> <input type='text' class='text dark ed_row_input' onKeyPress='Edit.onEnter(event, cur.onSaveClick);' onchange='Edit.autoCorrect(4, \"name"+e+"\")' id='name"+e+"' value=''/></div>",o+=Edit.genCorrectionControls(4,"name"+e,t),o+="</div>",n.content(o),val("name"+e,val(ge("street"+e).getElementsByTagName("b")[0])),Edit.loadAutocorrects(4);var a;cur.onSaveClick=function(){if(ge("name"+e).value.length>0){var t=val("name"+e);ajax.post("/editdb",{act:"a_edit_street",street:e,name:t},{showProgress:lockButton.pbind(a),hideProgress:unlockButton.pbind(a),onDone:function(n){Edit.hideBox(),ge("msg_street"+e).innerHTML=n,ge("street"+e).getElementsByTagName("b")[0].innerHTML=t},onFail:i.opFailed.pbind(e)})}else notaBene("name"+e)},n.addButton(getLang("global_cancel"),null,"no"),a=n.addButton(getLang("edit_editsave"),cur.onSaveClick,"",!0),n.show(),elfocus("name"+e,0)},showEditStreetsBox:function(){var e=Edit.getSelectedItems(i.streetName),t=val("autocorr_num"),n=new MessageBox({title:getLang("edit_editing_street_mul"),width:500}),o='<div id="auxFuncs">';o+=e.length>7?'<div id="inputDiv" style="overflow: auto; height: 233px">':'<div id="inputDiv">',o+="<table cellpadding=0>";for(var a="",r=0;r<e.length;++r){var c=parseInt(e[r]);a+="<tr><td><div style='padding:5px 0px;'><b>"+getLang("edit_street_name")+"</b><input type='text' onchange='Edit.autoCorrect(4, \"name"+c+"\")' style='width: 270px; margin-left: 5px' id='name"+c+"' value='"+ge("street"+c).getElementsByTagName("b")[0].innerHTML.replace(/'/g,"&#39;")+"'></div></td></tr>"}if(a.length){o+=a+"</table></div>",o+=Edit.genCorrectionControlsMul(4,"StreetEdit.streetName",t),o+="</div>",n.content(o),Edit.loadAutocorrects(4);var s;cur.onSaveClick=function(){for(var t={act:"a_rename_streets"},n=0;n<e.length;++n){var i=parseInt(e[n]),o=ge("name"+i);if(!o.value.length)return void o.focus();t["street"+n+"id"]=i,t["street"+n+"name"]=o.value}ajax.post("/editdb",t,{showProgress:lockButton.pbind(s),hideProgress:unlockButton.pbind(s),onDone:function(t){for(var n=0;n<e.length;++n){var i=parseInt(e[n]);ge("msg_street"+i).innerHTML=t[i].html,t[i].name&&(ge("name_street"+i).getElementsByTagName("b")[0].innerHTML=t[i].name)}Edit.hideBox()},onFail:function(){for(var t=0;t<e.length;++t){var n=parseInt(e[t]);ge("msg_street"+n).innerHTML=getLang("global_unknown_error")}}})},n.addButton(getLang("global_cancel"),null,"no"),s=n.addButton(getLang("edit_editsave"),cur.onSaveClick,"",!0),n.show()}},moveStreet:function(e){var t=void 0==e?Edit.getSelectedItems(i.streetName):[[e,i.streetName(ge("street"+e))]];t.length||(t=Edit.getAllItems(i.streetName));var n=Edit.getMessageBox("Перенести улицы",450,getLang("edit_move"),getLang("global_cancel"),function(){var e=ge("city1").value;if(e>0){var t=Edit.getIdList(r.selectedItems());if(!t)return;n.content(i.progressLine),ajax.post("/editdb",{act:"a_move_street",city:e,street:t},{onDone:function(e){n.hide();for(var t in e)1==e[t].code?(ge("actions_street"+t).innerHTML="",ge("msg_street"+t).innerHTML=e[t].html):ge("msg_street"+t).innerHTML=e[t].html},onFail:n.hide})}},"enter"),o=Edit.getAllItems(i.streetName);n.content('<div id="streetlist"></div><div id="moveBody" style="margin-top:10px;">'+i.progressLine+"</div>").show();var a=Edit.getDefaultListParams(t,o),r=new Autocomplete(ge("streetlist"),o,a),c=t[0][0];ajax.post("/editdb",{act:"a_get_cities",street:c},{onDone:function(e){ge("moveBody").innerHTML=e,selectsData.setCountries(cur.selData.countries),selectsData.setCities(cur.currentCountry[0],cur.selData.cities);var t=new CitySelect(ge("city1"),ge("city1_row"),{width:200,country:cur.currentCountry[0]});new CountrySelect(ge("country1"),ge("country1_row"),{width:200,citySelect:t,country:cur.currentCountry}),setTimeout(t.focus,0)}})},deleteSelectedStreets:function(e){var t=Edit.getSelectedItems(i.streetName);if(t.length){for(var n="",o=0;o<t.length;++o){var a=parseInt(t[o]);n+=a+","}n=n.substr(0,n.length-1),ajax.post("/editdb",{act:"a_delete_streets",street_list:n,city:e},{onDone:function(e,t){if(2==e&&t)for(var n in t)ge("msg_street"+n).innerHTML=t[n],ge("street"+n).getElementsByTagName("span")[0].style.display="none"}})}},streetDelSuccess:function(e,t,n){1==t?i.showDelStreetBox(e,n):(2==t&&Edit.hideBox(),ge("msg_street"+e).innerHTML=n,ge("street"+e).getElementsByTagName("span")[0].style.display="none",setTimeout(function(){ge("street"+e).style.opacity=.3},1e3),e==cur.mergeObject&&(cur.mergeObject=0))},showDelStreetBox:function(e,t){var n=new MessageBox({title:ge("street"+e).getElementsByTagName("a")[0].innerHTML});n.content(getLang("edit_street_suredelete")+t),addEvent(window,"keydown",function(e){Edit.onEnter(e,cur.onDelClick)});var o;return cur.onDelClick=function(){ajax.post("/editdb",{act:"a_real_del_street",street:e},{showProgress:lockButton.pbind(o),hideProgress:unlockButton.pbind(o),onDone:i.streetDelSuccess.pbind(e),onFail:i.opFailed.pbind(e)}),removeEvent(window,"keydown")},n.addButton(getLang("global_cancel"),null,"no"),o=n.addButton(getLang("global_delete"),cur.onDelClick,"",!0),n.show(),ge("del"+e+"link").blur(),!1},delStreet:function(e){ajax.post("/editdb",{act:"a_del_street",street:e},{onDone:i.streetDelSuccess.pbind(e),onFail:i.opFailed.pbind(e)})},restoreStreet:function(e){ajax.post("/editdb",{act:"a_restore_street",street:e},{onDone:function(t,n){t&&(ge("msg_street"+e).innerHTML=n,ge("street"+e).getElementsByTagName("span")[0].style.display="inline",setTimeout(function(){ge("street"+e).style.opacity=1},1e3))},onFail:i.opFailed.pbind(e)})},countStreet:function(e){ajax.post("/editdb",{act:"a_count_street",street:e},{onDone:function(t){ge("msg_street"+e).innerHTML=t},onFail:i.opFailed.pbind(e)}),ge("msg_street"+e).innerHTML=i.progressLine},boldSelectedStreets:function(e){var t=Edit.getSelectedItems(i.streetName);if(t.length){for(var n="",o=0;o<t.length;++o){var a=parseInt(t[o]);n+=a+","}n=n.substr(0,n.length-1),ajax.post("/editdb",{act:"a_bold_streets",street_list:n,city:e},{onDone:function(e,t){if(2==e&&t)for(var n in t){var i=ge("street"+n).getElementsByTagName("b")[0];i.style.fontWeight="bold",ge("sb"+n).innerHTML="<a href='javascript: StreetEdit.unBoldStreet("+n+")'>"+getLang("edit_unbold")+"</a>"}}})}},unboldSelectedStreets:function(e){var t=Edit.getSelectedItems(i.streetName);if(t.length){for(var n="",o=0;o<t.length;++o){var a=parseInt(t[o]);n+=a+","}n=n.substr(0,n.length-1),ajax.post("/editdb",{act:"a_unbold_streets",street_list:n,city:e},{onDone:function(e,t){if(2==e&&t)for(var n in t){var i=ge("street"+n).getElementsByTagName("b")[0];i.style.fontWeight="normal",ge("sb"+n).innerHTML="<a href='javascript: StreetEdit.boldStreet("+n+")'>"+getLang("edit_bold")+"</a>"}}})}},boldStreet:function(e){ajax.post("/editdb",{act:"a_bold_street",street:e},{onDone:function(){var t=ge("street"+e).getElementsByTagName("b")[0];t.style.fontWeight="bold",ge("sb"+e).innerHTML="<a href='javascript: StreetEdit.unBoldStreet("+e+")'>"+getLang("edit_unbold")+"</a>"},onFail:i.opFailed.pbind(e)})},unBoldStreet:function(e){ajax.post("/editdb",{act:"a_unbold_street",street:e},{onDone:function(){var t=ge("street"+e).getElementsByTagName("b")[0];t.style.fontWeight="normal",ge("sb"+e).innerHTML="<a href='javascript: StreetEdit.boldStreet("+e+")'>"+getLang("edit_bold")+"</a>"},onFail:i.opFailed.pbind(e)})}}},298:function(e,t,n){"use strict";function i(e){var t=c.get(e.currentTarget);if(t){var n=t[e.type];if(n)for(var i=void 0,o=0;o<n.length;o++){var a=r(n[o],2),s=a[0],d=a[1],l=void 0;if(hasClass(e.target,s)?l=d(e,e.target):(i=gpeByClass(s,e.target,e.currentTarget))&&(l=d(e,i)),l===!1)break}}}function o(e,t,n,o){var a=c.get(e);a||(c.set(e,{}),a=c.get(e));for(var r=t.split(" "),s=0;s<r.length;s++){var d=r[s];a[d]||(a[d]=[],addEvent(e,d,i)),a[d].push([n,o])}}function a(e,t,n,o){var a=c.get(e);if(a){t.split(" ").forEach(function(t){a[t]&&(a[t]=a[t].filter(function(e){return e[0]!==n||e[1]!==o}),0===a[t].length&&removeEvent(e,t,i))});var r=Object.keys(a).map(function(e){return a[e].length}).reduce(function(e,t){return e+t});0===r&&c["delete"](e)}}n.r(t),n.d(t,"addDelegateEvent",function(){return o}),n.d(t,"removeDelegateEvent",function(){return a});var r=function(){function e(e,t){var n=[],i=!0,o=!1,a=void 0;try{for(var r,c=e[Symbol.iterator]();!(i=(r=c.next()).done)&&(n.push(r.value),!t||n.length!==t);i=!0);}catch(s){o=!0,a=s}finally{try{!i&&c["return"]&&c["return"]()}finally{if(o)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),c=new window.Map},320:function(e,t,n){"use strict";n.r(t),n.d(t,"SchEdit",function(){return i});var i={progressLine:'<div style="padding:18px 0px 19px 0px;text-align: center"><img valign="middle" src="/images/progress7.gif"></div>',getSchoolTypes:function(){return[[0,getLang("select_school_type_0")],[1,getLang("select_school_type_1")],[2,getLang("select_school_type_2")],[3,getLang("select_school_type_3")],[4,getLang("select_school_type_4")],[5,getLang("select_school_type_5")],[6,getLang("select_school_type_6")],[7,getLang("select_school_type_7")],[8,getLang("select_school_type_8")],[9,getLang("select_school_type_9")],[10,getLang("select_school_type_10")],[11,getLang("select_school_type_11")],[12,getLang("select_school_type_12")],[13,getLang("select_school_type_13")],[14,getLang("select_school_type_14")],[15,getLang("select_school_type_15")],[16,getLang("select_school_type_16")]]},schoolName:function(e){return ge("name_"+e.id).innerHTML.replace(/<[^>]*>/g," ")},opFailed:function(e){ge("msg_school"+e).innerHTML=getLang("global_unknown_error")},showCreateSchoolBox:function(e,t){t=val("autocorr_num");var n=new MessageBox({title:getLang("edit_school_addingschool"),width:500}),o='<div id="auxFuncs">';o+="<div id=\"inputDiv\"><div class='ed_row_label'>"+getLang("edit_school_type")+"</div><input type='hidden' name='type' id='type' /><div class='ed_row_label'>"+getLang("edit_school_name")+"</div><textarea onKeyPress='onCtrlEnter(event, cur.onSaveClick);' onchange='Edit.autoCorrect(3);' class='ed_textarea text dark' id='name'></textarea><div id='create_school_msg'></div></div>",o+=Edit.genCorrectionControls(3,"name",t),o+="</div>",n.content(o);var a;cur.onSaveClick=function(){var t=val("name"),n=Edit.countRealLen(t,!0);if(hide("create_school_msg"),n>9e3)val("create_school_msg",getLang("text_exceeds_symbol_limit",n-9e3)),show("create_school_msg");else if(t.length>0){lockButton(a);var i=ge("type").value;ge("addActHidden").value="doCreateSchool",ge("addTypeHidden").value=i,ge("addNameHidden").value=t,ge("addCityHidden").value=e,ge("addFormHidden").submit()}else ge("name").focus()},n.addButton(getLang("global_cancel"),null,"no"),a=n.addButton(getLang("edit_add"),cur.onSaveClick,"",!0),n.show(),new Dropdown(ge("type"),i.getSchoolTypes(),{width:225,multiselect:!1,autocomplete:!1}),Edit.loadAutocorrects(3),elfocus("name")},setMergeObject:function(e){cur.mergeObject>0&&(ge("school"+cur.mergeObject).style.backgroundColor="#FFFFFF",ge("school"+cur.mergeObject).getElementsByTagName("a")[0].style.color="#2B587A",ge("msg_school"+cur.mergeObject).innerHTML=""),e!=cur.mergeObject?(ge("school"+e).style.backgroundColor="#E2E8ED",ge("school"+e).getElementsByTagName("a")[0].style.color="#36638E",
ge("msg_school"+e).innerHTML="<div class='report'>"+getLang("edit_school_youselected")+"</div>",cur.mergeObject=e):cur.mergeObject=0},mergeSchool:function(e){cur.mergeObject?(ajax.post("/editdb",{act:"a_merge_school_with_undo",school:e,main_school:cur.mergeObject},{onDone:function(t,n){n&&(2==t&&setTimeout(function(){ge("school"+e).style.opacity=.3},1e3),ge("school"+e).getElementsByTagName("span")[0].innerHTML="",ge("msg_school"+e).innerHTML=n)},onFail:i.opFailed.pbind(e)}),ge("msg_school"+e).innerHTML=i.progressLine):ge("msg_school"+e).innerHTML="<div class='reportGrey'>"+getLang("edit_school_youshould")+"</div>"},undoMergeSchool:function(e,t){ajax.post("/editdb",{act:"a_undo_merge_school",old_id:e,new_id:t},{onDone:i.schoolRestoreSuccess.pbind(e),onFail:i.opFailed.pbind(e)}),ge("msg_school"+e).innerHTML=i.progressLine},showEditSchoolsBox:function(){var e=Edit.getSelectedItems(i.schoolName),t=val("autocorr_num"),n=new MessageBox({title:getLang("edit_editing_school_mul"),width:500}),o='<div id="auxFuncs">';o+=e.length>7?'<div id="inputDiv" style="overflow: auto; height: 233px">':'<div id="inputDiv">',o+="<table cellpadding=0>";for(var a="",r=0;r<e.length;++r){var c=parseInt(e[r]);a+="<tr><td><div style='padding:5px 0px;'><b>"+getLang("edit_school_name")+"</b><input type='text' onchange='Edit.autoCorrect(3, \"name"+c+"\")' style='width: 270px; margin-left: 5px' id='name"+c+"' value='"+ge("school"+c).getElementsByTagName("b")[0].innerHTML.replace(/'/g,"&#39;")+"'></div></td></tr>"}a.length&&(o+=a+"</table></div>",o+=Edit.genCorrectionControlsMul(3,"SchEdit.schoolName",t),o+="</div>",n.content(o),Edit.loadAutocorrects(3),cur.onSaveClick=function(){for(var t={act:"a_rename_schools"},i=0;i<e.length;++i){var o=parseInt(e[i]),a=ge("name"+o);if(!a.value.length)return void a.focus();t["school"+i+"id"]=o,t["school"+i+"name"]=a.value}ajax.post("/editdb",t,{showProgress:n.showProgress,hideProgress:n.hideProgress,onDone:function(t){for(var n=0;n<e.length;++n){var i=parseInt(e[n]);ge("msg_school"+i).innerHTML=t[i].html,t[i].name&&(ge("name_school"+i).getElementsByTagName("b")[0].innerHTML=t[i].name)}Edit.hideBox()},onFail:function(){for(var t=0;t<e.length;++t){var n=parseInt(e[t]);ge("msg_school"+n).innerHTML=getLang("global_unknown_error")}}}),ge("boxMessage").innerHTML='<div style="text-align: center"><img valign="middle" src="/images/progress7.gif"></div>'},n.addButton(getLang("global_cancel"),null,"no"),n.addButton(getLang("edit_editsave"),cur.onSaveClick),n.show())},showEditSchoolBox:function(e){var t=val("autocorr_num"),n=ge("school"+e).getElementsByTagName("b")[0].innerHTML,o=new MessageBox({title:n,width:500}),a='<div id="auxFuncs">';a+="<div id=\"inputDiv\"><table cellpadding=0><tr><td valign=top><div style='padding:5px 0px;'><b>"+getLang("edit_school_type")+"</b></div> <input type='hidden' name='type"+e+"' id='type"+e+"' /><div style='padding:5px 0px;'><b>"+getLang("edit_school_name")+"</b></div> <input type='text' onblur='Edit.autoCorrect(3, \"name"+e+"\")' style='width: 352px' onKeyPress='Edit.onEnter(event, cur.onSaveClick);' id='name"+e+"' value='"+n.replace(/'/g,"&#39;")+"'> </td></tr></table></div>",a+=Edit.genCorrectionControls(3,"name"+e,t),a+="</div>",o.content(a);var r;cur.onSaveClick=function(){var t=val("name"+e);if(t){var n=val("type"+e),o=ge("name_school"+e).getElementsByTagName("b")[0].style.fontWeight;ajax.post("/editdb",{act:"a_edit_school",school:e,type:n,name:t},{showProgress:lockButton.pbind(r),hideProgress:unlockButton.pbind(r),onDone:function(n){void 0!=n.type&&(ge("name_school"+e).innerHTML="<em>"+n.type_name+"</em> <b>"+t+"</b>",ge("name_school"+e).getElementsByTagName("b")[0].style.fontWeight=o,ge("sct"+e).value=n.type),Edit.hideBox(),n.html&&(ge("msg_school"+e).innerHTML=n.html)},onFail:i.opFailed.pbind(e)})}else notaBene("name"+e)},r=Edit.addMessageBoxButtons(o,getLang("edit_editsave"),cur.onSaveClick),o.show(),new Dropdown(ge("type"+e),i.getSchoolTypes(),{width:360,multiselect:!1,autocomplete:!1,selectedItems:ge("sct"+e).value+""}),Edit.loadAutocorrects(3),elfocus("name"+e,0)},moveSchool:function(e){var t=void 0==e?Edit.getSelectedItems(i.schoolName):[[e,i.schoolName(ge("school"+e))]];t.length||(t=Edit.getAllItems(i.schoolName));var n=Edit.getMessageBox(getLang("edit_move_schools"),450,getLang("edit_move"),getLang("global_cancel"),function(){if(ge("city1").value>0){var e=Edit.getIdList(r.selectedItems());if(!e)return;ajax.post("/editdb",{act:"a_move_school",city:val("city1"),school:e},{hideProgress:n.hide,onDone:function(e){for(var t in e)1==e[t].code?(ge("actions_school"+t).innerHTML="",ge("msg_school"+t).innerHTML=e[t].html):ge("msg_school"+t).innerHTML=e[t].html}}),n.content(i.progressLine)}},"enter"),o=Edit.getAllItems(i.schoolName);n.content('<div id="schoollist"></div><div id="moveBody" style="margin-top:10px;">'+i.progressLine+"</div>").show();var a=Edit.getDefaultListParams(t,o),r=new Autocomplete(ge("schoollist"),o,a),c=t[0][0];ajax.post("/editdb",{act:"a_get_cities",school:c},{onDone:function(e){ge("moveBody").innerHTML=e,selectsData.setCountries(cur.selData.countries),selectsData.setCities(cur.currentCountry[0],cur.selData.cities);var t=new CitySelect(ge("city1"),ge("city1_row"),{width:200,country:cur.currentCountry[0]});new CountrySelect(ge("country1"),ge("country1_row"),{width:200,citySelect:t,country:cur.currentCountry})}})},deleteVoid:function(e){var t=Edit.getMessageBox(getLang("edit_deleting_void"),450,getLang("global_delete"),getLang("global_cancel"),function(){ajax.post("/editdb",{act:"a_delete_void_schools",sure:1,city_id:e},{onDone:function(n){n.code>0?(nav.go("editdb?act=schools&city="+e),t.hide()):t.content(n.html)},onFail:t.hide}),t.content(i.progressLine)},"enter");t.content(i.progressLine).show(),ajax.post("/editdb",{act:"a_delete_void_schools",city_id:e},{onDone:function(e){t.content(e.html)}})},schoolDelSuccess:function(e,t){t&&t[e]&&(t=t[e]),1==t.code?i.showDelSchoolBox(e,t.html):(ge("msg_school"+e).innerHTML=t.html,ge("actions_school"+e).innerHTML="",setTimeout(function(){ge("school"+e).style.opacity=.3},1e3))},delSchool:function(e){ajax.post("/editdb",{act:"a_del_school",school:e},{onDone:i.schoolDelSuccess.pbind(e),onFail:i.opFailed.pbind(e)})},deleteSchools:function(){var e=Edit.getSelectedItems(i.schoolName),t=Edit.getMessageBox(getLang("edit_schools_deleting"),450,getLang("global_delete"),getLang("global_cancel"),function(){var e=Edit.getIdList(c.selectedItems());if(e){removeEvent(ge("delSchoolLimit"),"change",n);var o=cur.uiSchoolLimit.checked()?parseInt(ge("delSchoolLimit").value):0;ajax.post("/editdb",{act:"a_real_del_school",school:e,limit:o},{onDone:function(e){for(var n in e)2==e[n].code?(ge("actions_school"+n).innerHTML="",ge("msg_school"+n).innerHTML=e[n].html):ge("msg_school"+n).innerHTML=e[n].html;setTimeout(function(){for(var t in e)2==e[t].code&&(ge("school"+t).style.opacity=.3)},1e3),t.hide()}}),t.content(i.progressLine)}},"enter"),n=function(){var e=Edit.getIdList(c.selectedItems());if(e){var t=cur.uiSchoolLimit.checked()?parseInt(val("delSchoolLimit")):0;ajax.post("/editdb",{act:"a_count_school",limit:t,school:e},{onDone:val.pbind("delCount")})}};t.content(getLang("edit_delete_schools")+'<div id="delSchoolList"></div><div style="padding:5px 0"><input id="delSchoolMulti" name="delSchoolMulti" type="hidden" /></div><div id="delCount"></div>').show();var o='<input style="width: 20px" onclick="uiSchoolLimit.checked(!uiSchoolLimit.checked())" type="text" id="delSchoolLimit" class="inputText" value="5" />';cur.uiSchoolLimit=new Checkbox(ge("delSchoolMulti"),{width:420,checked:!0,label:getLang("edit_nodelete_ifmorethan").replace("{count}",o),onChange:n});var a=Edit.getAllItems(i.schoolName),r=Edit.getDefaultListParams(e,a);r.onTagAdd=n,r.onTagRemove=n,addEvent(ge("delSchoolLimit"),"change",n);var c=new Autocomplete(ge("delSchoolList"),a,r);n()},showDelSchoolBox:function(e,t){var n=Edit.getMessageBox(ge("name_school"+e).innerHTML,300,getLang("global_delete"),getLang("global_cancel"),function(){ajax.post("/editdb",{act:"a_real_del_school",school:e},{onDone:i.schoolDelSuccess.pbind(e),onFail:i.opFailed.pbind(e)}),n.content(i.progressLine),n.hide()},"enter");return n.content("<div style='padding:5px 0px;'>"+getLang("edit_school_suredelete")+t+"</div>").show(),!1},restoreSchool:function(e){ajax.post("/editdb",{act:"a_restore_school",school:e},{onDone:i.schoolRestoreSuccess.pbind(e),onFail:i.opFailed.pbind(e)})},schoolRestoreSuccess:function(e,t,n){var i=document.createElement("div");i.innerHTML=n,ge("school"+e).innerHTML=i.lastChild.innerHTML,setTimeout(function(){ge("school"+e).style.opacity=1},1e3)},uniToSchool:function(e,t){ajax.post("/editdb",{act:"a_convert_uni_to_school",uni:e,school:t},{onDone:function(e){e&&(ge("msg_school"+t).innerHTML=e)},onFail:i.opFailed.pbind(t)}),ge("msg_school"+t).innerHTML=i.progressLine},makeUni:function(e){var t=void 0==e?Edit.getSelectedItems(i.schoolName):[[e,i.schoolName(ge("school"+e))]];t.length||(t=Edit.getAllItems(i.schoolName));var n=Edit.getMessageBox(getLang("edit_converting_to_unis"),450,getLang("edit_convertintouni"),getLang("global_cancel"),function(){var e=Edit.getIdList(r.selectedItems());e&&(ajax.post("/editdb",{act:"a_convert_school_to_uni",school:e},{onDone:function(e){for(var t in e)ge("actions_school"+t).innerHTML="",ge("msg_school"+t).innerHTML=e[t].html;n.hide()},onFail:n.hide}),n.content(i.progressLine))},"enter");n.content('<div id="makeUniList"></div>').show();var o=Edit.getAllItems(i.schoolName),a=Edit.getDefaultListParams(t,o),r=new Autocomplete(ge("makeUniList"),o,a)},countSchool:function(e){ajax.post("/editdb",{act:"a_count_school",school:e},{onDone:function(t){t&&(ge("msg_school"+e).innerHTML=t)},onFail:i.opFailed.pbind(e)}),ge("msg_school"+e).innerHTML=i.progressLine},openSchool:function(e){ajax.post("/editdb",{act:"a_open_school",school:e},{onDone:function(t){t&&(ge("openclose"+e).href="javascript: SchEdit.closeSchool("+e+");",ge("openclose"+e).innerHTML=getLang("edit_school_close"),ge("msg_school"+e).innerHTML=t)},onFail:i.opFailed.pbind(e)}),ge("msg_school"+e).innerHTML=i.progressLine},closeSchool:function(e){ajax.post("/editdb",{act:"a_close_school",school:e},{onDone:function(t){t&&(ge("openclose"+e).href="javascript: SchEdit.openSchool("+e+");",ge("openclose"+e).innerHTML=getLang("edit_school_open"),ge("msg_school"+e).innerHTML=t)},onFail:i.opFailed.pbind(e)}),ge("msg_school"+e).innerHTML=i.progressLine},boldAllSchools:function(e,t){ajax.post("/editdb",{act:"a_bold_schools",city:e},{onDone:function(n,o){if(2==n){for(var a=0;a<o.length;++a){var r=o[a],c=ge("name_school"+r);c&&(c.getElementsByTagName("b")[0].style.fontWeight="bold",ge("sb"+r).innerHTML="<a href='javascript: SchEdit.unBoldSchool("+r+")'>"+getLang("edit_unbold")+"</a>")}removeEvent(t,"click"),t.onclick="",addEvent(t,"click",function(){return i.unBoldAllSchools(e,t),!1}),t.innerHTML=getLang("edit_unbold_all_schools")}}})},unBoldAllSchools:function(e,t){ajax.post("/editdb",{act:"a_unbold_schools",city:e},{onDone:function(n,o){if(2==n){for(var a=0;a<o.length;++a){var r=o[a],c=ge("name_school"+r);c&&(c.getElementsByTagName("b")[0].style.fontWeight="normal",ge("sb"+r).innerHTML="<a href='javascript: SchEdit.boldSchool("+r+")'>"+getLang("edit_bold")+"</a>")}removeEvent(t,"click"),t.onclick="",addEvent(t,"click",function(){return i.boldAllSchools(e,t),!1}),t.innerHTML=getLang("edit_bold_all_schools")}}})},boldSchool:function(e){ajax.post("/editdb",{act:"a_bold_school",school:e},{onDone:function(t){var n=ge("school"+e).getElementsByTagName("b")[0];n.style.fontWeight="bold",ge("sb"+e).innerHTML="<a href='javascript: SchEdit.unBoldSchool("+e+")'>"+getLang("edit_unbold")+"</a>"},onFail:i.opFailed.pbind(e)})},unBoldSchool:function(e){ajax.post("/editdb",{act:"a_unbold_school",school:e},{onDone:function(){var t=ge("name_school"+e).getElementsByTagName("b")[0];t.style.fontWeight="normal",ge("sb"+e).innerHTML="<a href='javascript: SchEdit.boldSchool("+e+")'>"+getLang("edit_bold")+"</a>"},onFail:i.opFailed.pbind(e)})}}},341:function(e,t,n){"use strict";function i(){cur.mouseMoveHandler=function(e,t){return function(){e.style.backgroundColor=t}},cur.genCheckHandler=function(e,t,n){return function(i){var o={act:"a_change_editor_bits",user:t,country:n,hash:ge("hash"+t).value};o[e]=i?1:0,ajax.post("editdb",o)}},cur.addCountry=function(e){if(e||(e=cur.adding_to),cur.adding_to&&(ge("addCountry"+cur.adding_to).innerHTML="",cur.adding_to==e))return void(cur.adding_to=0);cur.adding_to=e;var t='<div class="enterID">Страна: </div><div class="enterID" id="enterID"><input type="text" class="inputText" id="addCountryID" name="addCountryID" /></div>';t+='<div class="bitsCheck"><input type="hidden" id="addCountryEdu" name="addCountryEdu"/></div>',t+='<div class="bitsCheck"><input type="hidden" id="addCountryStr" name="addCountryStr"/></div>',t+='<div id="addButtons"><div class="flat_button secondary button_small" onclick="cur.addCountry()">Отмена</div>',t+='<div class="flat_button button_small" onclick="cur.doAddCountry()">Добавить</div></div>',t+='<img src="images/upload.gif" id="addProgress" />',ge("addCountry"+e).innerHTML=t,new Checkbox(ge("addCountryEdu"),{width:120,label:"образование",checked:!0}),new Checkbox(ge("addCountryStr"),{width:65,label:"города",checked:!0}),new CountrySelect(ge("addCountryID"),ge("enterID"),{width:128}).val(-1,!0)},cur.doAddCountry=function(){ge("addCountryID").value&&(hide("addButtons"),show("addProgress"),cur.doAddEditor(cur.adding_to,val("addCountryID"),val("addCountryEdu"),val("addCountryStr"),"addProgress",function(e){if(e){var t=cur.adding_to;cur.adding_to=0,cur.addCountry(t)}else show("addButtons")}))},cur.deleteCountryRow=function(e,t){var n=ge("row"+e+"_"+t),i=geByClass1("country_row",n),o=ce("div");setStyle(o,"zIndex",2),setStyle(o,"position","absolute"),setStyle(o,"width",i.offsetWidth),setStyle(o,"height",i.offsetHeight),setStyle(o,"backgroundColor","#e9edf1"),setStyle(o,"opacity",.8),ge("row"+e+"_"+t).insertBefore(o,ge("row"+e+"_"+t).firstChild);var a=geByClass("delLink",i)[0];a.innerHTML="Отмена",a.href="javascript:cur.restoreCountryRow("+e+", "+t+")",a.style.position="relative",a.style.zIndex="3",removeClass(i,"country_row_hover"),addEvent(o,"mouseover",cur.mouseMoveHandler(o,"#e9edf1")),addEvent(o,"mouseout",cur.mouseMoveHandler(o,"#ffffff")),addEvent(a,"mouseover",cur.mouseMoveHandler(o,"#e9edf1")),addEvent(a,"mouseout",cur.mouseMoveHandler(o,"#ffffff")),ajax.post("editdb",{act:"a_delete_editor",user:e,country:t,hash:val("hash"+e)})},cur.restoreCountryRow=function(e,t){var n=ge("row"+e+"_"+t),i=n.firstChild,o=geByClass("delLink",n)[0];removeEvent(o,"mouseover"),removeEvent(o,"mouseout"),removeEvent(i,"mouseover"),removeEvent(i,"mouseout"),n.removeChild(i);var a=geByClass1("country_row",n);addClass(a,"country_row_hover"),o.innerHTML="Удалить",o.href="javascript:cur.deleteCountryRow("+e+", "+t+")",o.style.position="",o.style.zIndex="0",ajax.post("editdb",{act:"a_restore_editor",user:e,country:t,hash:val("hash"+e)})},cur.addEditor=function(){return ge("page").value?ge("country").value?void cur.doAddEditor(val("page"),val("country"),val("edu_right"),val("str_right"),"adding_progress",function(e){e||elfocus("page")}):void ge("country").focus():void ge("page").focus()},cur.doAddEditor=function(e,t,n,i,o,a){ajax.post("editdb",{act:"a_add_editor",page:e,country:t,edu:n,str:i,hash:ge("add_hash").value},{showProgress:show.pbind(o),hideProgress:hide.pbind(o),onDone:function(e,t,n){if(e){var i=n,o=ge("editors"),r=ce("div",{innerHTML:t},{display:"none"});ge("row"+i.id)?o.replaceChild(r,ge("row"+i.id)):o.insertBefore(r,o.firstChild),o.replaceChild(r.firstChild,r);for(var c=0;c<i.countries.length;++c){var s=i.countries[c];new Checkbox(ge("edu"+i.id+"_"+s.id),{width:120,label:"образование",checked:ge("edu"+i.id+"_"+s.id).value,onChange:cur.genCheckHandler("edu",i.id,s.id)}),new Checkbox(ge("str"+i.id+"_"+s.id),{width:65,label:"города",checked:ge("str"+i.id+"_"+s.id).value,onChange:cur.genCheckHandler("str",i.id,s.id)})}cur.users=[i].concat(cur.users)}a&&a(e)}})},cur.updateQuickfind=function(){var e,t,n=val("quick_find");if(n)for(e=0;e<cur.users.length;++e){for(var i=cur.users[e],o=i.name,a=-1,r="",c=-1,s=!1,d=o.toLowerCase();-1!=(a=d.indexOf(n));)r+=o.substr(0,a),r+="<em>"+o.substr(a,n.length)+"</em>",o=o.substr(a+n.length),d=d.substr(a+n.length),c=a,s=!0;for(t=0;t<i.countries.length;++t){for(var l=i.countries[t],g=l.name,u=-1,_="",m=g.toLowerCase();-1!=(u=m.indexOf(n));)_+=g.substr(0,u),_+="<em>"+g.substr(u,n.length)+"</em>",g=g.substr(u+n.length),m=m.substr(u+n.length),s=!0;_+=g,ge("link"+i.id+"_"+l.id).innerHTML=_}s?(r+=o,show("row"+i.id),ge("link"+i.id).innerHTML=r):hide("row"+i.id)}else for(e=0;e<cur.users.length;++e){var i=cur.users[e];for(show("row"+i.id),ge("link"+i.id).innerHTML=i.name,t=0;t<i.countries.length;++t){var l=i.countries[t];ge("link"+i.id+"_"+l.id).innerHTML=l.name}}}}n.r(t),n.d(t,"Admins",function(){return o});var o={initAdmins:function(){i(),placeholderSetup(ge("quick_find")),val("quick_find",""),each(cur.users,function(e,t){for(var n=0;n<t.countries.length;++n){var i=t.countries[n];new Checkbox(ge("edu"+t.id+"_"+i.id),{width:120,label:"образование",checked:val("edu"+t.id+"_"+i.id),onChange:cur.genCheckHandler("edu",t.id,i.id)}),new Checkbox(ge("str"+t.id+"_"+i.id),{width:65,label:"города",checked:val("str"+t.id+"_"+i.id),onChange:cur.genCheckHandler("str",t.id,i.id)})}}),new Checkbox(ge("edu_right"),{width:158,label:"образование",checked:!0}),new Checkbox(ge("str_right"),{width:158,label:"города",checked:!0}),new CountrySelect(ge("country"),ge("country_row"),{width:158}).val(-1,!0),cur.adding_to=0}}},347:function(e,t,n){"use strict";n.r(t),n.d(t,"UniEdit",function(){return i});var i={progressLine:'<div style="padding:18px 0px 19px 0px;text-align: center"><img valign="middle" src="/images/progress7.gif"></div>',uniName:function(e){return val("name_"+e.id)},uniOpSuccess:function(e,t){ge("uni"+e).getElementsByTagName("div")[0].innerHTML=t},uniOpFailed:function(e){ge("uni"+e).getElementsByTagName("div")[0].innerHTML=getLang("global_unknown_error")},showCreateUnisBox:function(e,t){var n=new MessageBox({title:getLang("edit_uni_addinguni"),width:500}),i='<div id="auxFuncs">';i+="<div id=\"inputDiv\"><div class='ed_row_label'>"+getLang("edit_uni_abbrevs")+"</div> <textarea onKeyPress='onCtrlEnter(event, cur.onSaveClick);' onchange='Edit.autoCorrect(2);' class='text dark ed_textarea' id='name'></textarea><div id='create_uni_msg'></div></td></tr></table></div>",i+=Edit.genCorrectionControls(2,"name",t),i+="</div>",n.content(i),Edit.loadAutocorrects(2);var o;cur.onSaveClick=function(){var t=val("name"),n=Edit.countRealLen(t,!0);hide("create_uni_msg"),n>9e3?(ge("create_uni_msg").innerHTML=getLang("text_exceeds_symbol_limit",n-9e3),show("create_uni_msg")):t?(lockButton(o),ge("addActHidden").value="doAddItem",ge("addItemHidden").value="Uni",ge("addNameHidden").value=t,ge("addParentIDHidden").value=e,ge("addFormHidden").submit()):notaBene("name")},n.addButton(getLang("global_cancel"),null,"no"),o=n.addButton(getLang("edit_add"),cur.onSaveClick,"",!0),n.show(),elfocus("name")},setMergeObject:function(e){cur.mergeObject>0&&(ge("uni"+cur.mergeObject).style.backgroundColor="#FFFFFF",ge("uni"+cur.mergeObject).getElementsByTagName("a")[0].style.color="#2B587A",ge("uni"+cur.mergeObject).getElementsByTagName("div")[0].innerHTML=""),e!=cur.mergeObject?(ge("uni"+e).style.backgroundColor="#E2E8ED",ge("uni"+e).getElementsByTagName("a")[0].style.color="#36638E",ge("uni"+e).getElementsByTagName("div")[0].innerHTML="<div class='report'>"+getLang("edit_uni_youselected")+"</div>",cur.mergeObject=e):cur.mergeObject=0},mergeUni:function(e){cur.mergeObject?(ajax.post("/editdb",{act:"a_merge_uni_with_undo",uni:e,main_uni:cur.mergeObject},{onDone:i.uniMergeSuccess.pbind(e),onFail:i.uniOpFailed.pbind(e)}),ge("uni"+e).getElementsByTagName("div")[0].innerHTML=i.progressLine):ge("uni"+e).getElementsByTagName("div")[0].innerHTML="<div class='reportGrey'>"+getLang("edit_uni_youshould")+"</div>"},uniMergeSuccess:function(e,t){t[e]&&(t=t[e]),t&&t.html?(ge("uni"+e).getElementsByTagName("span")[0].innerHTML="",ge("uni"+e).getElementsByTagName("div")[0].innerHTML=t.html,2==t.code&&setTimeout(function(){ge("uni"+e).style.opacity=.3},1e3)):ge("uni"+e).getElementsByTagName("div")[0].innerHTML=""},undoMergeUni:function(e,t){ajax.post("/editdb",{act:"a_undo_merge_uni",old_id:e,new_id:t},{onDone:function(t,n){if(t){var i=document.createElement("div");i.innerHTML=n,ge("uni"+e).innerHTML=i.lastChild.innerHTML,setTimeout(function(){ge("uni"+e).style.opacity=1},1e3)}},onFail:i.uniOpFailed.pbind(e)}),ge("uni"+e).getElementsByTagName("div")[0].innerHTML=i.progressLine},moveUni:function(e){var t=void 0==e?Edit.getSelectedItems(i.uniName):[[e,i.uniName(ge("uni"+e))]];t.length||(t=Edit.getAllItems(i.uniName));var n=Edit.getMessageBox(getLang("edit_move_unis"),500,getLang("edit_move"),getLang("global_cancel"),function(){var e=ge("city1").value,t=Edit.getIdList(r.selectedItems());t&&e&&(ajax.post("/editdb",{act:"a_move_uni",uni:t,city:e},{onDone:function(e){for(var t in e)ge("actions_uni"+t).innerHTML="",ge("msg_uni"+t).innerHTML=e[t].html;n.hide()}}),n.content(i.progressLine))},"enter");n.content('<div id="moveUniList"></div><div id="cityList" style="margin-top:10px;">'+i.progressLine+"</div>").show();var o=Edit.getAllItems(i.uniName),a=Edit.getDefaultListParams(t,o),r=new Autocomplete(ge("moveUniList"),o,a),c=t[0][0];ajax.post("/editdb",{act:"a_get_cities",uni:c},{onDone:function(e){ge("cityList").innerHTML=e,selectsData.setCountries(cur.selData.countries),selectsData.setCities(cur.currentCountry[0],cur.selData.cities);var t=new CitySelect(ge("city1"),ge("city1_row"),{width:220,country:cur.currentCountry[0]});new CountrySelect(ge("country1"),ge("country1_row"),{width:200,citySelect:t,country:cur.currentCountry})}})},showMoveUniBox:function(e){var t=new MessageBox({title:ge("uni"+e).getElementsByTagName("a")[0].innerHTML});ajax.post("/editdb",{act:"a_get_cities",uni:e},{onDone:function(e){t.content(e)},onFail:i.uniOpFailed.pbind(e)}),t.content('<div style="text-align: center"><img valign="middle" src="/images/progress7.gif"></div>');var n;cur.onMoveClick=function(){val("city1")>0&&ajax.post("/editdb",{act:"a_move_uni",city:val("city1"),uni:e},{showProgress:lockButton.pbind(n),hideProgress:unlockButton.pbind(n),onDone:i.uniMoved.pbind(e),onFail:i.uniOpFailed.pbind(e)})},t.addButton(getLang("global_cancel"),null,"no"),n=t.addButton(getLang("edit_move"),cur.onMoveClick,"",!0),t.show()},uniMoved:function(e,t){Edit.hideBox(),t[e]&&(t=t[e]),t&&t.html&&(ge("uni"+e).getElementsByTagName("div")[0].innerHTML=t.html,2==t.code&&setTimeout(function(){ge("uni"+ajaxObj.uni_id).style.opacity=.3},1e3))},restoreUni:function(e){ajax.post("/editdb",{act:"a_restore_uni",uni:e},{onDone:i.uniOpSuccess.pbind(e),onFail:i.uniOpFailed.pbind(e)}),ge("uni"+e).getElementsByTagName("div")[0].innerHTML=i.progressLine},restoreDelUni:function(e){ajax.post("/editdb",{act:"a_restore_del_uni",uni:e},{onDone:i.uniRestoreDelSuccess.pbind(e),onFail:i.uniOpFailed.pbind(e)})},uniRestoreDelSuccess:function(e,t,n){if(t){var i=document.createElement("div");i.innerHTML=n,ge("uni"+e).innerHTML=i.lastChild.innerHTML,setTimeout(function(){ge("uni"+e).style.opacity=1},1e3)}},delUni:function(e){ajax.post("/editdb",{act:"a_del_uni",uni:e},{onDone:i.uniDelSuccess.pbind(e),onFail:i.uniOpFailed.pbind(e)})},uniDelSuccess:function(e,t){t[e]&&(t=t[e]),1==t.code?i.showDelUniBox(e,t.html):(ge("msg_uni"+e).innerHTML=t.html,ge("actions_uni"+e).innerHTML="",setTimeout(function(){ge("uni"+e).style.opacity=.3},1e3))},showDelUniBox:function(e,t){var n=Edit.getMessageBox(ge("name_uni"+e).innerHTML,300,getLang("global_delete"),getLang("global_cancel"),function(){ajax.post("/editdb",{act:"a_real_del_uni",uni:e},{onDone:i.uniDelSuccess.pbind(e),onFail:i.uniOpFailed.pbind(e)}),n.content(i.progressLine),n.hide()},"enter");return n.content("<div style='padding:5px 0px;'>"+getLang("edit_uni_suredelete")+t+"</div>").show(),!1},deleteUnis:function(){var e=Edit.getSelectedItems(i.uniName),t=Edit.getMessageBox(getLang("edit_deleting_unis"),450,getLang("global_delete"),getLang("global_cancel"),function(){var e=Edit.getIdList(c.selectedItems());if(e){removeEvent(ge("delUniLimit"),"change",n);var o=cur.uiUniLimit.checked()?parseInt(ge("delUniLimit").value):0;ajax.post("/editdb",{act:"a_real_del_uni",uni:e,limit:o},{onDone:function(e){for(var n in e)2==e[n].code?(ge("actions_uni"+n).innerHTML="",ge("msg_uni"+n).innerHTML=e[n].html):ge("msg_uni"+n).innerHTML=e[n].html;t.hide()}}),t.content(i.progressLine)}},"enter"),n=function(){var e=Edit.getIdList(c.selectedItems());if(e){var t=cur.uiUniLimit.checked()?parseInt(ge("delUniLimit").value):0;ajax.post("/editdb",{act:"a_count_uni",limit:t,uni:e},{onDone:function(e){val("delCount",e)}})}};t.content(getLang("edit_delete_unis")+'<div id="delUniList"></div><div style="padding:5px 0"><input type="hidden" id="delUniMulti" name="delUniMulti" /></div><div id="delCount"></div>').show();var o='<input style="width: 20px" onclick="cur.uiUniLimit.checked(!cur.uiUniLimit.checked())" type="text" id="delUniLimit" class="inputText" value="5" />';cur.uiUniLimit=new Checkbox(ge("delUniMulti"),{width:420,checked:!0,label:getLang("edit_nodelete_ifmorethan").replace("{count}",o),onChange:n});var a=Edit.getAllItems(i.uniName),r=Edit.getDefaultListParams(e,a);r.onTagAdd=n,r.onTagRemove=n,addEvent(ge("delUniLimit"),"change",n);var c=new Autocomplete(ge("delUniList"),a,r);n()},deleteAllFacs:function(){for(var e=[],t=Edit.getSelectedItems(function(){return""}),n=0;n<t.length;++n)e.push(t[n][0]);var i=showBox("editdb?act=a_get_fac_by_unis&uni="+e.join(","),{},{onDone:function(){var t,n=function(){var n=e.join(",");ajax.post("editdb",{act:"a_del_fac_by_unis",uni:n},{showProgress:lockButton.pbind(t),onDone:i.hide})};addEvent(window,"keydown",function(e){var t=e||window.event;13==t.keyCode&&n()}),i.removeButtons(),t=Edit.addMessageBoxButtons(i,getLang("global_delete"),n)},params:{onHide:function(){removeEvent(window,"keydown")}}})},showEditUnisBox:function(){var e=Edit.getSelectedItems(i.uniName),t=val("autocorr_num"),n=new MessageBox({title:getLang("edit_editing_uni_mul"),width:500}),o='<div id="auxFuncs">';o+=e.length>7?'<div id="inputDiv" style="overflow: auto; height: 233px">':'<div id="inputDiv">',o+="<table cellpadding=0>";for(var a="",r=0;r<e.length;++r){var c=parseInt(e[r]),s=ge("uni"+c).getElementsByTagName("a")[0].innerHTML.replace(/'/g,"&#39;"),d=ge("uni_native_name"+c).value.replace(/'/g,"&#39;");s=s.replace(/<[a-z\/]+>/g,""),a+="<tr><td><div style='padding:5px 0px;'><b>"+getLang("edit_uni_name")+"</b><br><input type='text' onchange='Edit.autoCorrect(2, \"name"+c+"\")' style='width: 200px;' id='name"+c+"' value='"+s+"' /></div></td><td><div style='padding:5px 0px;'><b>"+getLang("edit_city_natname")+":</b><br><input type='text' onchange='Edit.autoCorrect(2, \"native_name"+c+"\")' style='width: 200px;' id='native_name"+c+"' value='"+d+"' /></div></td></tr>"}if(a.length){o+=a+"</table></div>",o+=Edit.genCorrectionControlsMul(2,"uniName",t),o+="</div>",n.content(o),Edit.loadAutocorrects(2);var l;cur.onSaveClick=function(){for(var t={act:"a_rename_unis"},n=0;n<e.length;++n){var i=parseInt(e[n]),o=ge("name"+i),a=ge("native_name"+i).value;if(!o.value.length)return void o.focus();t["uni"+n+"id"]=i,t["uni"+n+"name"]=o.value,t["uni"+n+"native_name"]=a}ajax.post("/editdb",t,{showProgress:lockButton.pbind(l),hideProgress:lockButton.pbind(l),onDone:function(t){for(var n=0;n<e.length;++n){var i=parseInt(e[n]);ge("uni"+i).getElementsByTagName("div")[0].innerHTML=t[i].html,t[i].name&&(ge("uni"+i).getElementsByTagName("a")[0].innerHTML=t[i].name),"native_name"in t[i]&&(ge("uni_native_name"+i).value=t[i].native_name)}Edit.hideBox()},onFail:function(){for(var t=0;t<e.length;++t){var n=parseInt(e[t]);ge("uni"+n).getElementsByTagName("div")[0].innerHTML=getLang("global_unknown_error")}Edit.hideBox()}})},n.addButton(getLang("global_cancel"),null,"no"),l=n.addButton(getLang("edit_editsave"),cur.onSaveClick,"",!0),n.show()}},showEditUniBox:function(e){var t=val("autocorr_num"),n=ge("uni"+e).getElementsByTagName("a")[0].innerHTML.replace(/'/g,"&#39;"),o=val("uni_native_name"+e).replace(/'/g,"&#39;");n=n.replace(/<[a-z\/]+>/g,"");var a=new MessageBox({title:ge("uni"+e).getElementsByTagName("a")[0].innerHTML,width:500}),r='<div id="auxFuncs"><div id="inputDiv">';r+="<div class='ed_row_label'>"+getLang("edit_uniabbr")+"</div> <input type='text' onKeyPress='Edit.onEnter(event, cur.onSaveClick);' onblur='Edit.autoCorrect(2, \"name"+e+"\")' class='text dark ed_row_input' id='name"+e+"' value='"+n+"'> <div class='ed_row_label'>"+getLang("edit_unifullname")+"</div> <input type='text' class='text dark ed_row_input' onKeyPress='Edit.onEnter(event, cur.onSaveClick);' id='fullname"+e+"' value='"+ge("uni"+e).getElementsByTagName("small")[0].innerHTML.replace(/'/g,"&#39;")+"'><div class='ed_row_label'>"+getLang("edit_city_natname")+"</div><input onKeyPress='Edit.onEnter(event, cur.onSaveClick);' class='text dark ed_row_input' type='text' id='native_name"+e+"' name='native_name"+e+"' value='"+o+"' /></div>",r+=Edit.genCorrectionControls(2,"name"+e,t),r+="</div>",a.content(r),Edit.loadAutocorrects(2);var c;cur.onSaveClick=function(){if(ge("name"+e).value.length>0){var t={name:val("name"+e),fullname:val("fullname"+e),native_name:val("native_name"+e),uni_id:e};ajax.post("/editdb",{act:"a_edit_uni",uni:e,name:t.name,fullname:t.fullname,native_name:t.native_name},{showProgress:lockButton.pbind(c),hideProgress:unlockButton.pbind(c),onDone:i.uniEdited.pbind(e,t.name,t.fullname,t.native_name),onFail:i.uniOpFailed.pbind(e)})}else notaBene("name"+e)},a.addButton(getLang("global_cancel"),null,"no"),c=a.addButton(getLang("edit_editsave"),cur.onSaveClick,"",!0),a.show(),elfocus("name"+e,0)},uniEdited:function(e,t,n,i,o){ge("uni"+e).getElementsByTagName("a")[0].innerHTML=t,ge("uni"+e).getElementsByTagName("small")[0].innerHTML=n,ge("uni_native_name"+e).value=i,Edit.hideBox(),o&&(ge("uni"+e).getElementsByTagName("div")[0].innerHTML=o)},sureDeleteUnis:function(e){var t=Edit.getSelectedItems(uniName),n=[];for(var i in t)n.push(t[i][0]);n=n.join(","),e&&e.parentNode&&e.parentNode.getElementsByTagName("img")[0]&&show(e.parentNode.getElementsByTagName("img")[0]),ajax.post("/editdb",{act:"a_real_del_uni",uni:n},{onDone:function(t){e&&e.parentNode&&e.parentNode.getElementsByTagName("img")[0]&&hide(e.parentNode.getElementsByTagName("img")[0]);for(var n in t)2==t[n].code?(ge("actions_uni"+n).innerHTML="",ge("msg_uni"+n).innerHTML=t[n].html):ge("msg_uni"+n).innerHTML=t[n].html},onFail:function(){e&&e.parentNode&&e.parentNode.getElementsByTagName("img")[0]&&hide(e.parentNode.getElementsByTagName("img")[0])}})},makeSchool:function(e){ajax.post("/editdb",{act:"a_convert_uni_to_school",uni:e},{onDone:i.uniOpSuccess.pbind(e),onFail:i.uniOpFailed.pbind(e)}),ge("uni"+e).getElementsByTagName("div")[0].innerHTML=i.progressLine},schoolToUni:function(e,t){ajax.post("/editdb",{act:"a_convert_school_to_uni",school:e,uni:t},{onDone:function(n){n[e]&&n[e].html&&(ge("uni"+t).getElementsByTagName("div")[0].innerHTML=n[e].html)},onFail:i.uniOpFailed.pbind(t)}),ge("uni"+t).getElementsByTagName("div")[0].innerHTML=i.progressLine},openNonEmptyFacsWindows:function(){var e=Edit.getSelectedItems(function(){return""});if(0==e.length){e=[];for(var t=0;t<pageItems.length;t++){var n=pageItems[t];e.push([parseInt(n.replace("uni","")),""])}}for(var t=0;t<e.length;++t){var i=ge("facs_count"+e[t][0]).value;i>0&&window.open("http://"+location.hostname+"/editdb?act=u&u="+e[t][0])}},countUni:function(e){ajax.post("/editdb",{act:"a_count_uni",uni:e},{onDone:i.uniOpSuccess.pbind(e),onFail:i.uniOpSuccess.pbind(e)}),ge("uni"+e).getElementsByTagName("div")[0].innerHTML=i.progressLine},closeUni:function(e){ajax.post("/editdb",{act:"a_close_uni",uni:e},{onDone:i.uniCloseSuccess.pbind(e),
onFail:i.uniOpFailed.pbind(e)}),ge("uni"+e).getElementsByTagName("div")[0].innerHTML=i.progressLine},uniCloseSuccess:function(e,t){t&&(ge("openclose"+e).href="javascript: UniEdit.openUni("+e+");",ge("openclose"+e).innerHTML=getLang("edit_open"),ge("uni"+e).getElementsByTagName("div")[0].innerHTML=t)},openUni:function(e){ajax.post("/editdb",{act:"a_open_uni",uni:e},{onDone:i.uniOpenSuccess.pbind(e),onFail:i.uniOpFailed.pbind(e)}),ge("uni"+e).getElementsByTagName("div")[0].innerHTML=i.progressLine},uniOpenSuccess:function(e,t){t&&(ge("openclose"+e).href="javascript: UniEdit.closeUni("+e+");",ge("openclose"+e).innerHTML=getLang("edit_close"),ge("uni"+e).getElementsByTagName("div")[0].innerHTML=t)}}},39:function(e,t,n){"use strict";function i(e){return{callMutations:function(){if("function"==typeof e)throw console.trace(),new Error("Mutations are not initialized");return e},bindMutations:function(){if("function"!=typeof e)throw console.trace(),new Error("Mutations are already initialized");return e=e.apply(void 0,arguments)}}}function o(e,t,n,i){l(t,n,i),e._registeredHandlers.push(["bind",t,n,i])}function a(e,t,n,i,o){Object(s.addDelegateEvent)(t,n,i,o),e._registeredHandlers.push(["delegate",t,n,i,o])}function r(e){var t={_registeredHandlers:[]};return e.handlers(o.bind(null,t),a.bind(null,t)),t}function c(e){e._registeredHandlers.forEach(function(e){var t=e.slice(1);"delegate"===e[0]?s.removeDelegateEvent.apply(void 0,t):g.apply(void 0,t)}),e._registeredHandlers=[]}n.r(t),n.d(t,"createMutations",function(){return i}),n.d(t,"createModule",function(){return r}),n.d(t,"destroyModule",function(){return c});var s=n(298),d=window,l=d.addEvent,g=d.removeEvent},409:function(e,t,n){"use strict";n.r(t),n.d(t,"CityEdit",function(){return i});var i={progressLine:'<div style="padding:18px 0px 19px 0px;text-align: center"><img valign="middle" src="/images/progress7.gif"></div>',cityOpFailed:function(e){val("msg_city"+e,getLang("global_unknown_error"))},cityOpSuccess:function(e,t){t&&val("msg_city"+e,t)},basicCityOp:function(e,t,n,o){ajax.post("/editdb",{act:t,city:e},{onDone:n.pbind(e),onFail:i.cityOpFailed.pbind(e)}),o||val("msg_city"+e,i.progressLine)},cityName:function(e){var t=e.id,n=ge("name_"+t).innerHTML;return ge("type_"+t).innerHTML&&(n+=" "+ge("type_"+t).innerHTML),ge("parent_"+t).innerHTML&&(n+=" ("+ge("parent_"+t).innerHTML+")"),n.replace(/<(?:.|\s)*?>/g,"")},setMergeObject:function(e){cur.mergeObject>0&&(ge("city"+cur.mergeObject).style.backgroundColor="#FFFFFF",ge("name_city"+cur.mergeObject).style.color="#2B587A",ge("msg_city"+cur.mergeObject).innerHTML=""),e!=cur.mergeObject?(ge("city"+e).style.backgroundColor="#E2E8ED",ge("name_city"+e).style.color="#36638E",ge("msg_city"+e).innerHTML="<div class='report'>"+getLang("edit_city_youselected")+"</div>",cur.mergeObject=e):cur.mergeObject=0},mergeCity:function(e,t){cur.mergeObject?t?(ajax.post("editdb",{act:"a_merge_city",city:e,main_city:cur.mergeObject},{onDone:i.cityMergeSuccess.pbind(e),onFail:i.cityOpFailed.pbind(e)}),ge("msg_city"+e).innerHTML=i.progressLine):i.showMergeCityBox(e):ge("msg_city"+e).innerHTML="<div class='reportGrey'>"+getLang("edit_city_youshould")+"</div>"},showMergeCityBox:function(e){var t=new MessageBox({title:getLang("global_action_confirmation")}),n=getLang("edit_city_suremerge").replace(/%s|{city1}/,ge("name_city"+e).innerHTML).replace(/%s|{city2}/,ge("name_city"+cur.mergeObject).innerHTML);t.content(n);var o;cur.onClick=function(){i.mergeCity(e,!0),lockButton(o),removeEvent(window,"keydown")},addEvent(window,"keydown",function(e){Edit.onEnter(e,cur.onClick)}),o=Edit.addMessageBoxButtons(t,getLang("edit_merge"),cur.onClick),t.show()},cityMergeSuccess:function(e,t){t[e]&&(t=t[e]),t&&t.html?(ge("actions_city"+e).innerHTML="",ge("msg_city"+e).innerHTML=t.html,2==t.code&&setTimeout(function(){ge("city"+e).style.opacity=.3},1e3)):ge("msg_city"+e).innerHTML="",Edit.hideBox()},setMergeRegion:function(e){cur.mergeRegionObject&&(ge("city"+cur.mergeRegionObject).style.backgroundColor="#FFFFFF",ge("name_city"+cur.mergeRegionObject).style.color="#2B587A",ge("msg_city"+cur.mergeRegionObject).innerHTML=""),e!=cur.mergeRegionObject?(ge("city"+e).style.backgroundColor="#E2E8ED",ge("name_city"+e).style.color="#36638E",ge("msg_city"+e).innerHTML="<div class='report'>"+getLang("edit_region_youselected")+"</div>",cur.mergeRegionObject=e):cur.mergeRegionObject=0},mergeRegion:function(e){cur.mergeRegionObject?(ajax.post("/editdb",{act:"a_merge_region",region:e,main_region:cur.mergeRegionObject},{onDone:i.regionMergeSuccess.pbind(e),onFail:i.cityOpFailed.pbind(e)}),ge("msg_city"+e).innerHTML=i.progressLine):ge("msg_city"+e).innerHTML="<div class='reportGrey'>"+getLang("edit_region_youshould")+"</div>"},regionMergeSuccess:function(e,t){t&&t[e]&&(t=t[e]),t&&t.html?(ge("actions_city"+e).innerHTML="",ge("msg_city"+e).innerHTML=t.html,2==t.code&&setTimeout(function(){ge("city"+e).style.opacity=.3},1e3)):ge("msg_city"+e).innerHTML=""},makeCity:function(e){ajax.post("/editdb",{act:"a_make_city",city:e},{onDone:i.makeCitySuccess.pbind(e),onFail:i.cityOpFailed.pbind(e)})},makeCitySuccess:function(e){ge("name_city"+e).style.fontWeight="bold",ge("cityvillage"+e).innerHTML="Make village",ge("cityvillage"+e).href="javascript:CityEdit.makeVillage("+e+")"},showMakeRegionBox:function(e){var t=new MessageBox({title:getLang("edit_move_to_regions")});t.content("<table cellpadding=0><tr><td valign=top><div style='padding: 10px 0'><div style='padding:5px 0px;'><b>"+getLang("edit_region_type")+"</b></div><input type='hidden' name='region_type' id='region_type'/></div></td></tr></table>");var n;cur.onClick=function(){var t=val("region_type");ajax.post("/editdb",{act:"a_make_region",city:e,type:t},{showProgress:lockButton.pbind(n),hideProgress:unlockButton.pbind(n),onDone:i.makeRegionSuccess.pbind(e),onFail:i.cityOpFailed.pbind(e)}),removeEvent(window,"keydown")},t.addButton(getLang("global_cancel"),null,"no"),n=t.addButton(getLang("edit_editsave"),cur.onClick,"ok",!0),t.show(),new Dropdown(ge("region_type"),[[0,getLang("edit_region")],[1,getLang("edit_district")]],{width:100})},makeRegionSuccess:function(e,t,n,i){Edit.hideBox(),ge("subcities_city"+e)&&val("subcities_city"+e),val("type_city"+e,"["+i+"]"),val("actions_city"+e,n),val("msg_city"+e,t)},showCreateCityBox:function(e,t){var n=Edit.getMessageBox(getLang("edit_city_addingcity"),395,getLang("edit_add"),getLang("global_cancel"),function(){var i=ge("names").value,o=Edit.countRealLen(i,!0);hide("create_city_msg"),o>9e3?(ge("names").focus(),ge("create_city_msg").innerHTML=getLang("text_exceeds_symbol_limit",o-9e3),show("create_city_msg")):i.length>0?ajax.post("/editdb",{ajax:1,act:"doAddItem",item:"City",name:i,parent_id:e,area_id:t||""},{onDone:function(e){n.hide(),e&&nav.go(e)}}):notaBene("names")},"ctrl-enter");n.content("<div style='padding:5px 0px;'><b>"+getLang("edit_city_name")+"</b></div><textarea class='text dark ed_textarea' id='names'></textarea><div id='create_city_msg'></div>").show(),elfocus("names")},showCreateRegionBox:function(e){var t=Edit.getMessageBox(getLang("edit_city_addingregion"),395,getLang("edit_add"),getLang("global_cancel"),function(){var n=ge("names").value,i=Edit.countRealLen(n,!0);hide("create_region_msg"),i>9e3?(ge("names").focus(),ge("create_region_msg").innerHTML=getLang("text_exceeds_symbol_limit",i-9e3),show("create_region_msg")):n.length>0?ajax.post("/editdb",{ajax:1,act:"doAddItem",item:"Region",name:n,type:ge("region_type").value,parent_id:e},{onDone:function(e){t.hide(),e&&nav.go(e)}}):notaBene("names")},"ctrl-enter");t.content("<div class='ed_row_label'>"+getLang("edit_region_name")+"</div><textarea class='text dark ed_textarea' id='names'></textarea><div style='padding: 10px 0'><div class='ed_row_label'>"+getLang("edit_region_type")+"</div><input type='hidden' name='region_type' id='region_type'/></div><div id='create_region_msg'></div>").show(),new Dropdown(ge("region_type"),[[0,getLang("edit_region")],[1,getLang("edit_district")]],{width:150}),elfocus("names")},delCity:function(e){ajax.post("/editdb",{act:"a_del_city",city:e},{onDone:i.cityDelSuccess.pbind(e),onFail:i.cityOpFailed.pbind(e)})},cityDelSuccess:function(e,t,n){2==n&&Edit.hideBox(),1==n?i.showDelCityBox(e,t):(Edit.hideBox(),ge("msg_city"+e).innerHTML=t,ge("actions_city"+e).innerHTML="",setTimeout(function(){ge("city"+e).style.opacity=.3},1e3))},showDelCityBox:function(e,t){var n=new MessageBox({title:ge("name_city"+e).innerHTML});n.content(getLang("edit_city_suredelete")+t),ge("del"+e+"link").blur();var o;cur.onDelClick=function(){ajax.post("/editdb",{act:"a_real_del_city",city:e},{showProgress:lockButton.pbind(o),hideProgress:unlockButton.pbind(o),onDone:i.cityDelSuccess.pbind(e),onFail:i.cityOpFailed.pbind(e)}),removeEvent(window,"keydown")},addEvent(window,"keydown",function(e){Edit.onEnter(e,cur.onDelClick)}),Edit.addMessageBoxButtons(n,getLang("global_delete"),cur.onDelClick),n.show()},delRegion:function(e){ajax.post("/editdb",{act:"a_del_region",city:e},{onDone:i.regionDelSuccess.pbind(e),onFail:i.cityOpFailed.pbind(e)})},regionDelSuccess:function(e,t,n){2==t&&Edit.hideBox(),1==t?i.showDelRegionBox(e,n):(Edit.hideBox(),ge("msg_city"+e).innerHTML=n,ge("actions_city"+e).innerHTML="",setTimeout(function(){ge("city"+e).style.opacity=.3},1e3))},showDelRegionBox:function(e,t){var n=new MessageBox({title:ge("name_city"+e).innerHTML});n.content("Вы уверены, что хотите удалить этот регион?"+t),addEvent(window,"keydown",function(e){Edit.onEnter(e,cur.onDelClick)}),ge("del"+e+"link").blur();var o;cur.onDelClick=function(){ajax.post("/editdb",{act:"a_real_del_region",city:e},{showProgress:lockButton.pbind(o),hideProgress:unlockButton.pbind(o),onDone:i.regionDelSuccess.pbind(e),onFail:i.cityOpFailed.pbind(e)}),removeEvent(window,"keydown")},o=Edit.addMessageBoxButtons(n,getLang("global_delete"),cur.onDelClick),n.show()},showEditCityBox:function(e){var t=new MessageBox({title:val("name_city"+e),width:450});t.content("<table cellpadding=0><tr><td valign=top><div style='padding:5px 0px;'><b>"+getLang("edit_city_name")+"</b></div> <input type='text' onKeyPress='if (event.keyCode==13) {return cur.onSubmitClick();}' style='width: 352px' id='name"+e+"' value='"+ge("name_city"+e).innerHTML.replace(/'/g,"&#39;")+"'></td></tr><tr><td valign=top><div style='padding:5px 0px;'><b>"+getLang("edit_city_natname")+"</b></div> <input type='text' onKeyPress='if (event.keyCode==13) {return cur.onSubmitClick();}' style='width: 352px' id='native_name"+e+"' value='"+ge("native_city"+e).innerHTML.replace(/'/g,"&#39;")+"'></td></tr><tr><td style='color:#666;font-size:10px; line-height:200%; padding-top:5px'>"+getLang("edit_city_ifsame")+"</td></tr><tr><td valign=top><div style='padding:5px 0px;'><b>"+getLang("edit_city_type")+"</b></div> <input type='hidden' id='city_type"+e+"'></td></tr></table>");var n=new Dropdown(ge("city_type"+e),cur.selData.cityTypes,{width:200,selectedItems:ge("type_city"+e).getAttribute("val"),multiselect:!1});cur.onSubmitClick=function(){var t=val("name"+e);if(!t)return void notaBene("name"+e);var a={act:"a_edit_city",city:e,name:val("name"+e),native_name:val("native_name"+e),city_type:n.val(),city_id:e};ajax.post("/editdb",a,{showProgress:lockButton.pbind(o),hideProgress:lockButton.pbind(o),onDone:i.cityEdited.pbind(e,a),onFail:i.cityOpFailed.pbind(e)})},t.addButton(getLang("global_cancel"),null,"no");var o=t.addButton(getLang("edit_editsave"),cur.onSubmitClick,"",!0);t.show(),elfocus("name"+e,0)},cityEdited:function(e,t,n){if(ge("name_city"+e).innerHTML=t.name,ge("native_city"+e).innerHTML=t.native_name,t.city_type){var i="";for(var o in cur.selData.cityTypes)cur.selData.cityTypes[o][0]==t.city_type&&(i=cur.selData.cityTypes[o][1]);ge("type_city"+e).setAttribute("val",t.city_type),ge("type_city"+e).innerHTML="["+i+"]"}Edit.hideBox(),n&&(ge("msg_city"+e).innerHTML=n)},showEditRegionBox:function(e){var t=new MessageBox({title:val("name_city"+e)});t.content("<table cellpadding=0><tr><td valign=top><div style='padding:5px 0px;'><b>"+getLang("edit_region_name")+"</b></div> <input type='text' onKeyPress='Edit.onEnter(event, cur.onClick);' style='width: 352px' id='name"+e+"' value='"+ge("name_city"+e).innerHTML.replace(/'/g,"&#39;")+"'></td></tr><tr><td valign=top><div style='padding:5px 0px;'><b>"+getLang("edit_city_natname")+"</b></div> <input type='text' onKeyPress='Edit.onEnter(event, cur.onClick);' style='width: 352px' id='native_name"+e+"' value='"+ge("native_city"+e).innerHTML.replace(/'/g,"&#39;")+"'></td></tr><tr><td style='color:#666;font-size:10px; line-height:200%; padding-top:15px'>"+getLang("edit_city_ifsame")+"</td></tr></table>");var n;cur.onClick=function(){if(ge("name"+e).value.length>0){var t={act:"a_edit_region",region:e,name:val("name"+e),native_name:val("native_name"+e)};ajax.post("/editdb",t,{showProgress:lockButton.pbind(n),hideProgress:unlockButton.pbind(n),onDone:i.cityEdited.pbind(e,t),onFail:i.cityOpFailed.pbind(e)})}else ge("name"+e).focus()},n=Edit.addMessageBoxButtons(t,getLang("edit_editsave"),cur.onClick),t.show(),elfocus("name"+e,0)},showEditCitiesBox:function(){var e=Edit.getSelectedItems(i.cityName),t=val("autocorr_num"),n=new MessageBox({title:"Редактирование городов"}),o='<div id="auxFuncs">';o+=e.length>7?'<div id="inputDiv" style="overflow: auto; height: 233px">':'<div id="inputDiv">',o+="<table cellpadding=0>";for(var a="",r=0;r<e.length;++r){var c=parseInt(e[r]);a+="<tr><td><div style='padding:5px 0px;'><b>"+getLang("edit_city_name")+"</b><input type='text' onchange='Edit.autoCorrect(9, \"name"+c+"\")' style='width: 270px; margin-left: 5px' id='name"+c+"' value='"+ge("city"+c).getElementsByTagName("a")[0].innerHTML.replace(/'/g,"&#39;")+"'></div></td></tr>"}if(a.length){o+=a+"</table></div>",o+=Edit.genCorrectionControlsMul(9,"CityEdit.cityName",t),o+="</div>",n.content(o),Edit.loadAutocorrects(9);var s;cur.onClick=function(){for(var t={act:"a_rename_cities"},n=0;n<e.length;++n){var i=parseInt(e[n]),o=ge("name"+i);if(!o.value.length)return void o.focus();t["city"+n+"id"]=i,t["city"+n+"name"]=o.value}ajax.post("/editdb",t,{showProgress:lockButton.pbind(s),hideProgress:unlockButton.pbind(s),onDone:function(t){for(var n=0;n<e.length;++n){var i=parseInt(e[n]);ge("msg_city"+i).innerHTML=t[i].html,t[i].name&&(ge("name_city"+i).getElementsByTagName("b")[0].innerHTML=t[i].name)}Edit.hideBox()},onFail:function(){for(var t=0;t<e.length;++t){var n=parseInt(e[t]);ge("msg_city"+n).innerHTML=getLang("global_unknown_error")}}})},s=Edit.addMessageBoxButtons(n,getLang("edit_editsave"),cur.onClick),n.show()}},showMoveCityBox:function(e,t){var n=-1==e?Edit.getSelectedItems(i.cityName):[[e,i.cityName(ge("city"+e))]];n.length||(n=Edit.getAllItems(i.cityName));var o=Edit.getMessageBox(getLang("edit_moving_city"),450,getLang("edit_move"),getLang("global_cancel"),function(){if(ge("region4").value>0){var e=Edit.getIdList(c.selectedItems());if(!e)return;var t={act:"a_move_city",parent:ge("region4").value,city:e};o.content('<div style="text-align: center"><img valign="middle" src="/images/progress7.gif"></div>'),ajax.post("editdb",t,{hideProgress:o.hide,onDone:function(e){for(var t in e)1==e[t].code?ge("parent_city"+t).innerHTML=e[t].region:ge("msg_city"+t).innerHTML=getLang("global_unknown_error")}})}},"enter"),a=Edit.getAllItems(i.cityName);o.content('<div id="citylist"></div><div id="moveBody" style="margin-top:10px;"><div style="text-align: center"><img valign="middle" src="/images/progress7.gif"></div></div>').show();var r=Edit.getDefaultListParams(n,a);r.onValidate=function(e,t){var n=t.toLowerCase().split(/\s*,\s*/);if(n.length<2)return[];var i=[];return each(e,function(e,t){-1!=indexOf(n,t[1].toLowerCase())&&i.push(t)}),i};var c=new Autocomplete(ge("citylist"),"editdb?act=a_city_list&cr="+t,r),s=n[0][0];ajax.post("/editdb",{act:"a_get_regions",city:s},{onDone:function(e){ge("moveBody").innerHTML=e,selectsData.setCountries(cur.selData.countries);var t=!1;t=new Selector(ge("region4"),"",{width:200,defaultItems:[[0,getLang("select_region_not_selected")]].concat(cur.selData.regions),placeholder:getLang("select_region_not_selected"),placeholderColor:"#000",multiselect:!1,dropdown:!0,autocomplete:!0,onChange:function(e){intval(e)||t.clear()}}),t.setData(cur.selData.regions),new CountrySelect(ge("country4"),ge("country4_row"),{width:200,country:cur.currentCountry,onChange:function(e){intval(e)?ajax.post("editdb",{act:"a_get_regions_json",country_id:e},{oDone:function(e){t.setOptions({defaultItems:[[0,getLang("select_region_not_selected")]].concat(e)}),t.setData(e),show("region4_row")}}):hide("region4_row")}})}})},countCity:function(e){i.basicCityOp(e,"a_count_city",i.cityOpSuccess)},countRegion:function(e){ajax.post("/editdb",{act:"a_count_region",region:e},{onDone:i.cityOpSuccess.pbind(e),onFail:i.cityOpFailed.pbind(e)}),ge("msg_city"+e).innerHTML=i.progressLine},closeCity:function(e){i.basicCityOp(e,"a_close_city",i.cityCloseSuccess)},cityCloseSuccess:function(e,t){t&&(ge("openclose"+e).href="javascript:CityEdit.openCity("+e+");",ge("openclose"+e).innerHTML=getLang("edit_openunis"),ge("msg_city"+e).innerHTML=t)},closeCitySt:function(e){i.basicCityOp(e,"a_close_city_st",i.cityCloseStSuccess)},cityCloseStSuccess:function(e,t){t&&(ge("openclosest"+e).href="javascript:CityEdit.openCitySt("+e+");",ge("openclosest"+e).innerHTML=getLang("edit_open_streets"),ge("msg_city"+e).innerHTML=t)},openCity:function(e){i.basicCityOp(e,"a_open_city",i.cityOpenSuccess)},cityOpenSuccess:function(e,t){t&&(ge("openclose"+e).href="javascript:CityEdit.closeCity("+e+");",ge("openclose"+e).innerHTML=getLang("edit_closeunis"),ge("msg_city"+e).innerHTML=t)},closeCitySc:function(e){i.basicCityOp(e,"a_close_city_sc",i.cityCloseScSuccess)},cityCloseScSuccess:function(e,t){t&&(ge("openclosesc"+e).href="javascript:CityEdit.openCitySc("+e+");",ge("openclosesc"+e).innerHTML=getLang("edit_openschools"),ge("msg_city"+e).innerHTML=t)},openCitySc:function(e){i.basicCityOp(e,"a_open_city_sc",i.cityOpenScSuccess)},cityOpenScSuccess:function(e,t){t&&(ge("openclosesc"+e).href="javascript:CityEdit.closeCitySc("+e+");",ge("openclosesc"+e).innerHTML=getLang("edit_closeschools"),ge("msg_city"+e).innerHTML=t)},openCitySt:function(e){i.basicCityOp(e,"a_open_city_st",i.cityOpenStSuccess)},cityOpenStSuccess:function(e,t){t&&(ge("openclosest"+e).href="javascript:CityEdit.closeCitySt("+e+");",ge("openclosest"+e).innerHTML=getLang("edit_close_streets"),ge("msg_city"+e).innerHTML=t)},makeVillage:function(e){i.basicCityOp(e,"a_make_village",i.makeVillageSuccess,!0)},makeVillageSuccess:function(e){ge("name_city"+e).style.fontWeight="normal",ge("cityvillage"+e).innerHTML="Make city",ge("cityvillage"+e).href="javascript:CityEdit.makeCity("+e+");"},makeCityFromRegion:function(e){i.basicCityOp(e,"a_make_city_from_region",i.makeCityFromRegionSuccess,!0)},makeCityFromRegionSuccess:function(e,t,n){t&&(ge("msg_city"+e).innerHTML=t,n&&(ge("actions_city"+e).innerHTML=n),ge("type_city"+e).innerHTML="")},openNonEmptyUnisWindows:function(){var e=Edit.getSelectedItems(function(){return""});if(0==e.length){e=[];for(var t=0;t<cur.pageItems.length;t++){var n=cur.pageItems[t];e.push([parseInt(n.replace("city","")),""])}}for(var t=0;t<e.length;++t){var i=ge("unis_count"+e[t][0])?ge("unis_count"+e[t][0]).value:0;i>0&&window.open("https://"+location.hostname+"/editdb?act=c&c="+e[t][0])}},openNonEmptySchoolsWindows:function(){var e=Edit.getSelectedItems(function(){return""});if(0==e.length){e=[];for(var t=0;t<cur.pageItems.length;t++){var n=cur.pageItems[t];e.push([parseInt(n.replace("city","")),""])}}for(var t=0;t<e.length;++t){var i=ge("schools_count"+e[t][0])?ge("schools_count"+e[t][0]).value:0;i>0&&window.open("https://"+location.hostname+"/editdb?act=schools&city="+e[t][0])}},openNonEmptyStreetsWindows:function(){var e=Edit.getSelectedItems(function(){return""});if(0==e.length){e=[];for(var t=0;t<cur.pageItems.length;t++){var n=cur.pageItems[t];e.push([parseInt(n.replace("city","")),""])}}for(var t=0;t<e.length;++t){var i=ge("streets_count"+e[t][0])?ge("streets_count"+e[t][0]).value:0;i>0&&window.open("https://"+location.hostname+"/editdb?act=streets&city="+e[t][0])}},closeAllStreets:function(e,t){var n=new MessageBox({title:getLang("global_warning")});n.content(getLang("edit_sure_close_cities")),n.addButton(getLang("global_cancel"),null,"no"),n.addButton(t,function(){ajax.post("editdb",{act:"closeAllStreets",cr:e})})},closeAllEdu:function(e,t){var n=new MessageBox({title:getLang("global_warning")});n.content(getLang("edit_sure_close_cities_unis")),n.addButton(getLang("global_cancel"),null,"no"),n.addButton(t,function(){ajax.post("editdb",{act:"closeAllEdu",cr:e})}),n.show()}}},458:function(e,t,n){"use strict";n.r(t),n.d(t,"ChairEdit",function(){return i});var i={progressLine:'<div style="padding:18px 0px 19px 0px;text-align: center"><img valign="middle" src="/images/progress7.gif"></div>',msg:function(e,t,n){t?(n&&(t='<div class="'+n+'">'+t+"</div>"),val("msg_chair"+e,t)):val("msg_chair"+e,"")},chairName:function(e){return val(e)},getChairName:function(e){return i.chairName(ge("name_chair"+e))},opFailed:function(e){i.msg(e,getLang("global_unknown_error"))},showCreateChairBox:function(e,t){var n=new MessageBox({title:getLang("edit_chair_addingchair"),width:500}),i='<div id="auxFuncs">';i+="<div id=\"inputDiv\"><div class='ed_row_label'>"+getLang("edit_chair_name")+"</div> <textarea onKeyPress='onCtrlEnter(event, cur.onSaveClick);' onchange='Edit.autoCorrect(7);' class='ed_textarea' id='name'></textarea><div id='create_chair_msg'></div></div>",i+=Edit.genCorrectionControls(7,"name",t),i+="</div>",n.content(i),Edit.loadAutocorrects(7);var o;cur.onSaveClick=function(){var t=val("name"),n=Edit.countRealLen(t,!0);hide("create_chair_msg"),n>9e3?(ge("create_chair_msg").innerHTML=getLang("text_exceeds_symbol_limit",n-9e3),show("create_chair_msg")):t.length>0?(ge("addActHidden").value="doAddItem",ge("addItemHidden").value="Chair",ge("addNameHidden").value=t,ge("addParentIDHidden").value=e,ge("addFormHidden").submit(),lockButton(o)):notaBene("name")},n.addButton(getLang("global_cancel"),null,"no"),o=n.addButton(getLang("edit_add"),cur.onSaveClick,"",!0),n.show(),elfocus("name")},moveChairs:function(){var e=Edit.getSelectedItems(i.chairName);e.length||(e=Edit.getAllItems(i.chairName));var t=Edit.getMessageBox(getLang("edit_move_chairs"),450,getLang("edit_move"),getLang("global_cancel"),function(){var e=val("fac3"),n=Edit.getIdList(a.selectedItems());n&&e&&(ajax.post("/editdb",{act:"a_move_chairs",chair_ids:n,fac_id:e},{onDone:function(e){for(var n in e)val("actions_chair"+n,""),val("msg_chair"+n,e[n].html);t.hide()}}),t.content(i.progressLine))},"enter");t.content('<div id="moveChairsList"></div><div id="facList" style="margin-top:10px;">'+i.progressLine+"</div>").show();var n=Edit.getAllItems(i.chairName),o=Edit.getDefaultListParams(e,n),a=new Autocomplete(ge("moveChairsList"),n,o),r=e[0][0];ajax.post("/editdb",{act:"a_get_facs",fac:r},{onDone:function(e,t,n){val("facList",t);var i=new FacultySelect(ge("fac3"),ge("fac3_row"),{width:200,university:cur.currentUni,faculty:cur.currentFac}),o=new UniversitySelect(ge("uni3"),ge("uni3_row"),{width:200,city:cur.currentCity[0],university:cur.currentUni,facultySelect:i}),a=new CitySelect(ge("city3"),ge("city3_row"),{width:200,country:cur.currentCountry[0],city:cur.currentCity,universitySelect:o});new CountrySelect(ge("country3"),ge("country3_row"),{width:200,country:cur.currentCountry,citySelect:a})}})},showMoveChairBox:function(e){var t,n=showBox("editdb",{act:"a_get_facs",chair:e,title:i.getChairName(e)},{onFail:i.opFailed.pbind(e),params:{width:400}});cur.onMoveClick=function(){val("fac3")>0&&ajax.post("/editdb",{act:"a_move_chair",fac:ge("fac3").value,chair:e},{showProgress:lockButton.pbind(t),hideProgress:unlockButton.pbind(t),onDone:function(t,n){Edit.hideBox(),2==t&&setTimeout(function(){addClass("chair"+e,"ed_row_removed")},1e3),ge("msg_chair"+e).innerHTML=n},onFail:i.opFailed.pbind(e)})},n.removeButtons().addButton(getLang("global_cancel"),null,"no"),t=n.addButton(getLang("edit_move"),cur.onMoveClick,"",!0)},setMergeObject:function(e){cur.mergeObject>0&&(ge("chair"+cur.mergeObject).style.backgroundColor="#FFFFFF",ge("chair"+cur.mergeObject).getElementsByTagName("a")[0].style.color="#2B587A",i.msg(cur.mergeObject,"")),e!=cur.mergeObject?(ge("chair"+e).style.backgroundColor="#E2E8ED",ge("chair"+e).getElementsByTagName("a")[0].style.color="#36638E",i.msg(e,getLang("edit_chair_youselected"),"report"),cur.mergeObject=e):cur.mergeObject=0},mergeChair:function(e){cur.mergeObject?(ajax.post("/editdb",{act:"a_merge_chair",chair:e,main_chair:cur.mergeObject},{onDone:function(t,n){n&&(2==t&&setTimeout(function(){addClass("chair"+e,"ed_row_removed")},1e3),hide("actions_chair"+e),val("msg_chair"+e,n))},onFail:i.opFailed.pbind(e)}),ge("msg_chair"+e).innerHTML=i.progressLine):val("msg_chair"+e,"<div class='reportGrey'>"+getLang("edit_chair_youshould")+"</div>")},restoreMergedChair:function(e){ajax.post("/editdb",{act:"a_restore_merged_chair",chair:e},{onDone:function(e){for(var t in e)val("msg_chair"+t,e[t].html),show("actions_chair"+t),removeClass("chair"+t,"ed_row_removed")},onFail:i.opFailed.pbind(e)})},showEditChairsBox:function(){var e=Edit.getSelectedItems(i.chairName),t=val("autocorr_num"),n=new MessageBox({title:getLang("edit_editing_chair_mul"),width:700}),o='<div id="auxFuncs">';o+=e.length>8?'<div id="inputDiv" style="overflow: auto; height: 400px">':'<div id="inputDiv">',o+='<table class="ed_form_table ed_form_table_hor">';for(var a,r,c="",a=0;a<e.length;++a)r=parseInt(e[a]),c+=cur.editChairRowBoxHtml.replace(/%chair_id%/g,r);if(c.length){o+=c+"</table></div>",o+=Edit.genCorrectionControlsMul(7,"ChairEdit.chairName",t),o+="</div>",n.content(o);for(var a=0;a<e.length;++a)r=parseInt(e[a]),val("name"+r,i.getChairName(r)).replace("&amp;","&"),val("native_name"+r,val("chair_native_name"+r)).replace("&amp;","&");Edit.loadAutocorrects(7);var s;cur.onSaveClick=function(){for(var t={act:"a_rename_chairs"},n=0;n<e.length;++n){var i=parseInt(e[n]),o=ge("name"+i),a=ge("native_name"+i).value;if(!o.value.length)return void o.focus();t["chair"+n+"id"]=i,t["chair"+n+"name"]=o.value,t["chair"+n+"native_name"]=a}ajax.post("/editdb",t,{showProgress:lockButton.pbind(s),hideProgress:unlockButton.pbind(s),onDone:function(t){for(var n=0;n<e.length;++n){var i=parseInt(e[n]);ge("msg_chair"+i).innerHTML=t[i].html,t[i].name&&(ge("name_chair"+i).innerHTML=t[i].name),"native_name"in t[i]&&(ge("chair_native_name"+i).value=t[i].native_name)}Edit.hideBox()},onFail:function(){for(var t=0;t<e.length;++t){var n=parseInt(e[t]);ge("msg_chair"+n).innerHTML=getLang("global_unknown_error")}}})},s=Edit.addMessageBoxButtons(n,getLang("edit_editsave"),cur.onSaveClick),n.show()}},showEditChairBox:function(e){var t=val("autocorr_num"),n=new MessageBox({title:i.getChairName(e),width:500}),o=i.getChairName(e),a=val("chair_native_name"+e),r='<div id="auxFuncs">';r+=cur.editChairBoxHtml.replace(/%chair_id%/g,e),r+=Edit.genCorrectionControls(7,"name"+e+",native_name"+e,t),n.content(r),val("name"+e,o).replace("&amp;","&"),val("native_name"+e,a).replace("&amp;","&"),Edit.loadAutocorrects(7);var c;cur.onSaveClick=function(){var t={name:val("name"+e),native_name:val("native_name"+e)};ge("name"+e).value.length>0?ajax.post("/editdb",{act:"a_edit_chair",chair:e,name:t.name,native_name:t.native_name},{showProgress:lockButton.pbind(c),hideProgress:unlockButton.pbind(c),onDone:function(n){ge("name_chair"+e).innerHTML=t.name,ge("chair_native_name"+e).value=t.native_name,Edit.hideBox(),n&&(ge("msg_chair"+e).innerHTML=n)},onFail:i.opFailed.pbind(e)}):notaBene("name"+e)},n.addButton(getLang("global_cancel"),null,"no"),c=n.addButton(getLang("edit_editsave"),cur.onSaveClick,"",!0),n.show(),elfocus("name"+e,0)},chairDelSuccess:function(e,t){t[e]&&(t=t[e]),t&&void 0!==t.code&&(2==t.code&&Edit.hideBox(),1==t.code?i.showDelChairBox(e,t.html):(ge("msg_chair"+e).innerHTML=t.html,setTimeout(function(){addClass("chair"+e,"ed_row_removed")},1e3)))},showDelChairBox:function(e,t){var n=new MessageBox({title:i.getChairName(e)});n.content(getLang("edit_chair_suredelete")+t),ge("del"+e+"link").blur();var o;cur.onDelClick=function(){ajax.post("/editdb",{act:"a_real_del_chair",chair:e},{showProgress:lockButton.pbind(o),hideProgress:unlockButton.pbind(o),onDone:i.chairDelSuccess.pbind(e),onFail:i.opFailed.pbind(e)}),removeEvent(window,"keydown")},addEvent(window,"keydown",function(e){Edit.onEnter(e,cur.onDelClick)}),n.addButton(getLang("global_cancel"),null,"no"),o=n.addButton(getLang("global_delete"),cur.onDelClick,"",!0),n.show()},delChair:function(e){ajax.post("/editdb",{act:"a_del_chair",chair:e},{onDone:i.chairDelSuccess.pbind(e),onFail:i.opFailed.pbind(e)})},deleteChairs:function(e){e.preventDefault();var t=Edit.getSelectedItems(i.chairName),n=Edit.getMessageBox(getLang("edit_deleting_chairs"),450,getLang("global_delete"),getLang("global_cancel"),function(){var e=Edit.getIdList(c.selectedItems());e&&(ajax.post("/editdb",{act:"a_real_del_chair",chair:e},{onDone:function(e){each(e,function(e,t){val("actions_chair"+e,""),val("msg_chair"+e,t.html)}),setTimeout(function(){for(var t in e)addClass("chair"+t,"ed_row_removed")},1e3),n.hide()}}),n.content(i.progressLine))},"enter");n.content(getLang("edit_delete_chairs")+'<div id="delChairList"></div><div id="delCount"></div>').show();var o=Edit.getAllItems(i.chairName),a=Edit.getDefaultListParams(t,o),r=function(){var e=Edit.getIdList(c.selectedItems());ajax.post("/editdb",{act:"a_count_chair",nolink:1,chair:e},{onDone:function(e){ge("delCount").innerHTML=e}})};a.onTagAdd=r,a.onTagRemove=r;var c=new Autocomplete(ge("delChairList"),o,a);r()},restoreChair:function(e){ajax.post("/editdb",{act:"a_restore_chair",chair:e},{onDone:function(t,n){t&&(show("actions_chair"+e),val("msg_chair"+e,n),removeClass("chair"+e,"ed_row_removed"))},onFail:i.opFailed.pbind(e)})},styleBoldName:function(e){addClass("chair"+e,"ed_item_bolded")},styleUnboldName:function(e){removeClass("chair"+e,"ed_item_bolded")},bold:function(e){ajax.post("/editdb",{act:"a_bold_chair",chair_id:e},{onDone:i.styleBoldName.pbind(e),onFail:i.opFailed.pbind(e)})},unbold:function(e){ajax.post("/editdb",{act:"a_unbold_chair",chair_id:e},{onDone:i.styleUnboldName.pbind(e),onFail:i.opFailed.pbind(e)})},boldAll:function(e,t){ajax.post("/editdb",{act:"a_bold_chairs",fac_id:e},{onDone:function(n){for(var o=0;o<n.length;++o)i.styleBoldName(n[o]);removeEvent(t,"click"),t.onclick="",addEvent(t,"click",function(){return i.unboldAll(e,t),!1}),t.innerHTML=getLang("edit_unbold_all_chairs")},onFail:i.opFailed})},unboldAll:function(e,t){ajax.post("/editdb",{act:"a_unbold_chairs",fac_id:e},{onDone:function(n){for(var o=0;o<n.length;++o)i.styleUnboldName(n[o]);removeEvent(t,"click"),t.onclick="",addEvent(t,"click",function(){return i.boldAll(e,t),!1}),t.innerHTML=getLang("edit_bold_all_chairs")},onFail:i.opFailed})},countChair:function(e){ajax.post("/editdb",{act:"a_count_chair",chair:e},{onDone:function(t){ge("msg_chair"+e).innerHTML=t},onFail:i.opFailed.pbind(e)}),ge("msg_chair"+e).innerHTML=i.progressLine},closeChair:function(e){ajax.post("/editdb",{act:"a_close_chair",chair:e},{onDone:function(t){ge("openclose"+e).href="javascript: ChairEdit.openChair("+e+");",ge("openclose"+e).innerHTML=getLang("edit_chair_open"),ge("msg_chair"+e).innerHTML=t},onFail:i.opFailed.pbind(e)}),ge("msg_chair"+e).innerHTML=i.progressLine},openChair:function(e){ajax.post("/editdb",{act:"a_open_chair",chair:e},{onDone:function(t){ge("openclose"+e).href="javascript: ChairEdit.closeChair("+e+");",ge("openclose"+e).innerHTML=getLang("edit_chair_close"),ge("msg_chair"+e).innerHTML=t},onFail:i.opFailed.pbind(e)}),ge("chair"+e).getElementsByTagName("div")[0].innerHTML=i.progressLine}}},471:function(e,t,n){"use strict";n.r(t),n.d(t,"DistrictEdit",function(){return i});var i={progressLine:'<div style="padding:18px 0px 19px 0px;text-align: center"><img valign="middle" src="/images/progress7.gif"></div>',
opSuccess:function(e,t){t&&(ge("msg_district"+e).innerHTML=t)},opFailed:function(e){ge("msg_district"+e).innerHTML=getLang("global_unknown_error")},showCreateDistrictBox:function(e,t){var n=new MessageBox({title:getLang("edit_addingdistricts"),width:500}),i='<div id="auxFuncs">';i+="<div id=\"inputDiv\"><div class='ed_row_label'>"+getLang("edit_district_name")+"</div> <textarea onKeyPress='onCtrlEnter(event, cur.onSaveClick);' onchange='Edit.autoCorrect(8);' class='text dark ed_textarea' id='name'></textarea><div id='create_district_msg'></div></div>",i+=Edit.genCorrectionControls(8,"name",t),i+="</div>",n.content(i),Edit.loadAutocorrects(8);var o;cur.onSaveClick=function(){var t=ge("name").value,n=Edit.countRealLen(t,!0);hide("create_district_msg"),n>9e3?(ge("create_district_msg").innerHTML=getLang("text_exceeds_symbol_limit",n-9e3),show("create_district_msg")):t.length>0?(lockButton(o),ge("addActHidden").value="doCreateDistrict",ge("addNameHidden").value=t,ge("addCityHidden").value=e,ge("addFormHidden").submit()):notaBene("name")},o=Edit.addMessageBoxButtons(n,getLang("edit_add"),cur.onSaveClick),n.show(),elfocus("name")},deleteDistrict:function(e){ajax.post("/editdb",{act:"a_del_district",district:e},{onDone:i.districtDelSuccess.pbind(e),onFail:i.opFailed.pbind(e)})},districtDelSuccess:function(e,t,n){void 0!==t&&(2==t&&Edit.hideBox(),1==t?i.showDelDistrictBox(e,n):(ge("msg_district"+e).innerHTML=n,ge("district"+e).getElementsByTagName("span")[0].style.display="none",setTimeout(function(){ge("district"+e).style.opacity=.3},1e3)))},showDelDistrictBox:function(e,t){var n,o=ge("district"+e).getElementsByTagName("b")[0].innerHTML,a=new MessageBox({title:o});return cur.onDelClick=function(){ajax.post("/editdb",{act:"a_real_del_district",district:e},{showProgress:lockButton.pbind(n),hideProgress:unlockButton.pbind(n),onDone:i.districtDelSuccess.pbind(e),onFail:i.opFailed.pbind(e)}),removeEvent(window,"keydown")},a.content("<table cellpadding=0><tr><td valign=top><div style='padding:5px 0px;'>"+getLang("edit_district_suredelete")+t+"</div></td></tr></table>"),a.addButton(getLang("global_cancel"),function(){a.hide(),removeEvent(window,"keydown")},"no"),n=a.addButton(getLang("global_delete"),cur.onDelClick,"",!0),addEvent(window,"keydown",function(e){Edit.onEnter(e,cur.onDelClick)}),a.show(),ge("del"+e+"link").blur(),!1},showEditDistrictBox:function(e){var t=new MessageBox({title:ge("district"+e).getElementsByTagName("a")[0].innerHTML,width:500});t.content("<div class='ed_row_label'>"+getLang("edit_district_name")+"</div><input type='text' class='text dark ed_row_input' onKeyPress='Edit.onEnter(event, cur.onSaveClick);' id='name"+e+"' value='"+ge("district"+e).getElementsByTagName("b")[0].innerHTML.replace(/'/g,"&#39;")+"'>");var n;cur.onSaveClick=function(){var t=val("name"+e);if(t){var o={act:"a_edit_district",district:e,name:t};ajax.post("/editdb",o,{showProgress:lockButton.pbind(n),hideProgress:unlockButton.pbind(n),onDone:function(t){Edit.hideBox(),t&&(ge("msg_district"+e).innerHTML=t,ge("district"+e).getElementsByTagName("b")[0].innerHTML=o.name)},onFail:i.opFailed.pbind(e)})}else notaBene("name"+e)},t.addButton(getLang("global_cancel"),null,"no"),n=t.addButton(getLang("edit_editsave"),cur.onSaveClick,"",!0),t.show(),elfocus("name"+e,0)},restoreDistrict:function(e){ajax.post("/editdb",{act:"a_restore_district",district:e},{onDone:function(t,n){t&&(ge("msg_district"+e).innerHTML=n,ge("district"+e).getElementsByTagName("span")[0].style.display="inline",setTimeout(function(){ge("district"+e).style.opacity=1},1e3))},onFail:i.opFailed.pbind(e)})},countDistrict:function(e){ajax.post("/editdb",{act:"a_count_district",district:e},{onDone:i.opSuccess.pbind(e),onFail:i.opFailed.pbind(e)}),ge("msg_district"+e).innerHTML=i.progressLine}}},492:function(e,t,n){"use strict";function i(e){function t(e){var t=getUrlParam("country_id");selectsData.setCountries(e.full_countries),window.uiCountry=new CountrySelect(ge("country_select"),ge("country_select_row"),{big:!0,width:f,country:t,autocomplete:!0,placeholder:"Все страны",noDefaultCountry:!0,full_list:!1,citySelect:window.citySelect,onChange:E.loadByFilters})}function n(){var e=getUrlParam("country_id"),t=getUrlParam("city_id");window.citySelect=new CitySelect(ge("city_select"),ge("city_select_row"),{big:!0,width:f,country:e,city:t,autocomplete:!0,onChange:E.loadByFilters})}function i(){window.statusFilter=new Dropdown(ge("status_filter"),e.statuses,{selectedItems:e.selected_status||0,onChange:E.loadByFilters,big:!0,width:f})}function o(e){addEvent(window,"scroll",E.loadNextLogsOnScroll),addClass(geByClass1("narrow_column"),"fixed"),window.initOptions=e}function a(){function t(){var e=geByClass1("geodb_page"),t=Object(_.createModule)({handlers:function(t,n){n(e,"mouseup","_country_requests_link",function(e){return c(e.target)}),n(e,"mouseup","_city_requests_link",function(e){return c(e.target)}),n(e,"input","requests_input",function(e){return d(e.target)}),n(e,"mouseup","user_education",function(e){return r(e.target)}),n(e,"click","ban_requests_button",function(e){return g(e.target)}),n(e,"click","unban_requests_button",function(e){return u(e.target)})}});cur.destroy.push(function(){Object(_.destroyModule)(t)})}var n=Object(_.createMutations)(t),i=(n.callMutations,n.bindMutations);i(e)}n(),t(e),i(),o(e),a()}function o(e){var t=hasClass(e,v)?e:gpeByClass(v,e);return intval(t.id.replace("row",""))}function a(e){var t=geByClass(v);t.forEach(function(t){if(domData(t,w)==e){var n=o(t);E.closeRequest(n)}})}function r(e){var t=gpeByClass("user_education",e),n=geByClass1("other_higher_education",t),i=geByClass1("other_education",t);toggleClass(n,"shown"),toggleClass(i,"shown")}function c(e){var t=domData(e,"href"),n=E.getFilterParams();return t=t.replace(/universities=(\d)/,"universities="+n.universities),t=t.replace(/faculties=(\d)/,"faculties="+n.faculties),t=t.replace(/chairs=(\d)/,"chairs="+n.chairs),t=t.replace(/schools=(\d)/,"schools="+n.schools),t=t.replace(/streets=(\d)/,"streets="+n.streets),e.target===m.TARGET_BLANK?window.open(t,m.TARGET_BLANK):window.location.replace(t),!1}function s(e){var t=E.getElementInCurrentRequestRow(e,"helper_actions_list");if(!isVisible(t))return!1;var n=geByClass1("header",t);return n?n.innerHTML:null}function d(e){e.textContent=e.textContent}function l(e){var t=E.getElementInCurrentRequestRow(e,"helper_actions_list");hide(t)}function g(e){var t=o(e);ajax.post("geodb.php",{act:"a_ban_requests_for_user",request_id:t},{onDone:function(t){var n=domNS(e);toggleClass(e,"shown"),toggleClass(n,"shown");var i=domData(gpeByClass(v,e),w);return a(i),showDoneBox(t),!0},onFail:function(e){return showDoneBox(e),!0}})}function u(e){var t=o(e);ajax.post("geodb.php",{act:"a_unban_requests_for_user",request_id:t},{onDone:function(t){var n=domPS(e);return toggleClass(e,"shown"),toggleClass(n,"shown"),showDoneBox(t),!0},onFail:function(e){return showDoneBox(e),!0}})}n.r(t),n.d(t,"RequestsFunctions",function(){return E}),n.d(t,"init",function(){return i});var _=n(39),m=n(196),v="request_row",p=500,h=1e3,f=207,y="Все соседи",b="Схожие по имени",L="Схожие по цифрам",w="user_id",E={timer:setTimeout(null),loadLock:!1,pageCounter:1,getRequestRow:function(e){return ge("row"+e)},getElementInCurrentRequestRow:function(e,t){return geByClass1(t,E.getRequestRow(e))},findAllSiblings:function(e){if(s(e)==y)return void l(e);var t=E.getElementInCurrentRequestRow(e,"progress_bar");ajax.post("geodb.php",{act:"a_get_request_parent_list",request_id:e},{onDone:E.substituteSiblings.pbind(y,e),onFail:showDoneBox.pbind(),showProgress:show.pbind(t),hideProgress:hide.pbind(t)})},findSiblingsByName:function(e){if(s(e)==b)return void l(e);var t=E.getElementInCurrentRequestRow(e,"progress_bar");ajax.post("geodb.php",{act:"a_search_siblings",request_id:e,name:val("requested_object_name"+e)},{onDone:E.substituteSiblings.pbind(b,e),onFail:showDoneBox.pbind(),showProgress:show.pbind(t),hideProgress:hide.pbind(t)})},findSiblingsByNumbers:function(e){if(s(e)==L)return void l(e);var t=E.getElementInCurrentRequestRow(e,"progress_bar"),n=E.findNumbers(e);ajax.post("geodb.php",{act:"a_search_siblings",request_id:e,name:n},{onDone:E.substituteSiblings.pbind(L,e),onFail:showDoneBox.pbind(),showProgress:show.pbind(t),hideProgress:hide.pbind(t)})},findNumbers:function(e){for(var t=E.getRequestRow(e),n=val(geByClass1("requests_input",t)),i=/\d+/g,o=[],a=i.exec(n);null!==a;)o.push(a[0]),a=i.exec(n);for(var r="",c=0;c<o.length;c++)r+=o[c];return r},substituteSiblings:function(e,t,n){var i="";if(0!==n.length&&n!==!1)for(var o in n){var a=n[o],r=a.name,c=a.fullname;i+=getTemplate("sibling",{name:r,full_name:c,request_id:t,object_id:a.id})}else i="Ничего не найдено";var s=E.getElementInCurrentRequestRow(t,"helper_actions_list");s.innerHTML=getTemplate("siblings_list",{header:e,siblings:i}),show(s)},showFeedbackBox:function(e,t){showBox("geodb",{act:"a_request_feedback_box",request_id:e,object_id:t},{onDone:function(t){t.removeButtons(),t.addButton(getLang("global_cancel"),null,"no"),t.addButton("Отправить",E.sendFeedback.pbind(e),!1,!1,"submit_button"),ge("substitute_object_input").click(),GeodbPage.addCurrentBoxCtrlEnterShortcut(E.sendFeedback.pbind(e))},onFail:showDoneBox.pbind()})},getFeedbackBoxRequestId:function(){return ge("feedback_box_request_id").innerHTML},isCurrentTabDenial:function(){return hasClass(geByClass1("ui_tab_sel"),"no_tab")?1:0},getFeedbackBoxDefaultSection:function(){return ge("feedback_box_default_section").innerHTML},getFeedbackBoxTextarea:function(){return ge("feedback_text")},switchTabs:function(e,t){uiTabs.switchTab(e),E.updateFeedbackBoxContent(t),ge("substitute_object_input").click()},updateFeedbackBoxContent:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!1,n=GeodbPage.geByClassInCurBox("loader_icon"),i=E.getFeedbackBoxRequestId(),o=E.isCurrentTabDenial();ajax.post("geodb.php",{act:"a_get_request_feedback_text",request_id:i,section:e,object_id:t,is_denial:o},{onDone:function(e){ge("tabs_content").innerHTML=e,ge("substitute_object_input").click()},onFail:showDoneBox.pbind(),showProgress:show.pbind(n),hideProgress:hide.pbind(n)})},onSubstituteObjectInputKeyDown:function(){var e=domData(geByClass1("ui_tab_sel"),"section"),t=val("substitute_object_input");clearTimeout(E.timer),E.timer=setTimeout(E.updateFeedbackBoxContent.pbind(e,t),p)},sendFeedback:function(e){var t=ge("submit_button"),n=val(E.getFeedbackBoxTextarea());ajax.post("geodb",{act:"a_send_feedback",request_id:e,text:n},{onDone:function(){E.closeRequest(e),curBox().hide()},onFail:showDoneBox.pbind("global_error"),showProgress:lockButton.pbind(t),hideProgress:unlockButton.pbind(t)})},skipRequest:function(e){var t=geByClass1("skip_request_button",E.getRequestRow(e));ajax.post("geodb.php",{act:"a_skip_request",request_id:e},{onDone:E.closeRequest.pbind(e),onFail:showDoneBox.pbind("global_error"),showProgress:lockButton.pbind(t),hideProgress:unlockButton.pbind(t)})},reopenRequest:function(e){var t=geByClass1("reopen_request_button",E.getRequestRow(e));ajax.post("geodb",{act:"a_reopen_request",request_id:e},{onDone:function(){E.openRequest(e)},onFail:function(e){showDoneBox(e)},showProgress:lockButton.pbind(t),hideProgress:unlockButton.pbind(t)})},getRequestedUserName:function(e){var t=GeodbPage.getObjectRow(e);return geByClass1("user_name",t).innerHTML},loadByFilters:function(){E.pageCounter=0;var e=geByClass1("loader",geByClass1("page_block_header_inner")),t=E.getFilterParams();GeodbPage.updateUrl(t),E.pageCounter++;var n=extend(t,{act:"requests",page:E.pageCounter,only_rows:!0});ajax.post("geodb",n,{onDone:function(e,t){geByClass1("request_rows").innerHTML=e?e.join(""):"",geByClass1("total_found_amount").innerHTML=t,scrollToTop()},onFail:function(e){showDoneBox(e)},showProgress:function(){removeClass(e,"not_displayed"),hide(geByClass1("total_found_label"))},hideProgress:function(){addClass(e,"not_displayed"),show(geByClass1("total_found_label"))}})},loadNextLogsOnScroll:function(){if(!E.loadLock&&window.innerHeight+window.scrollY>=document.body.offsetHeight-h){E.loadLock=!0,E.pageCounter++;var e=extend(E.getFilterParams(),{act:"requests",page:E.pageCounter,only_rows:!0});ajax.post("geodb",e,{onDone:function(e){if(0===e.length)E.loadLock=!0;else{var t=geByClass1("request_rows");t.innerHTML+=e.join(""),E.loadLock=!1}},onFail:showDoneBox.pbind(),showProgress:show.pbind("autoload_progress"),hideProgress:hide.pbind("autoload_progress")})}},getFilterParams:function(){return{status:GeodbPage.isFilterSectionActive("closed_filter_wrap")?window.statusFilter.val():null,is_asc_sorting:GeodbPage.isFilterSectionActive("is_asc_sorting_filter_wrap")?GeodbPage.getFilterValue("is_asc_sorting_filter"):null,user_id:GeodbPage.isFilterSectionActive("id_filter_inputs_wrap")&&val("search_by_user_id")?val("search_by_user_id"):null,request_id:GeodbPage.isFilterSectionActive("id_filter_inputs_wrap")&&val("search_by_request_id")?val("search_by_request_id"):null,country_id:GeodbPage.isFilterSectionActive("location_filters_input_wrap")?val("country_select"):null,city_id:GeodbPage.isFilterSectionActive("location_filters_input_wrap")&&val("country_select")?val("city_select"):null,universities:GeodbPage.getFilterValue("universities_filter"),faculties:GeodbPage.getFilterValue("faculties_filter"),chairs:GeodbPage.getFilterValue("chairs_filter"),schools:GeodbPage.getFilterValue("schools_filter"),streets:GeodbPage.getFilterValue("streets_filter")}},loadByFiltersOnInputChange:function(){clearTimeout(E.timer),E.timer=setTimeout(E.loadByFilters,p)},toggleFilter:function(e){toggleClass(e,"on"),E.loadByFilters()},hasAnySection:function(){var e=E.getFilterParams();return e.universities||e.faculties||e.chairs||e.schools||e.streets},closeRequest:function(e){var t=E.getRequestRow(e);addClass(t,"closed"),hide(geByClass1("opened_actions",t)),show(geByClass1("closed_actions",t));var n=geByClass1("date",t);addClass(n,"red_text"),n.innerHTML="Закрыта только что"},openRequest:function(e){var t=E.getRequestRow(e);removeClass(t,"closed"),show(geByClass1("opened_actions",t)),hide(geByClass1("closed_actions",t));var n=geByClass1("date",t);removeClass(n,"red_text"),n.innerHTML="Заново открыта только что"}}},501:function(e,t,n){e.exports=n(213)},502:function(e,t,n){"use strict";n.r(t),n.d(t,"MILLISECOND",function(){return i}),n.d(t,"SECOND",function(){return o}),n.d(t,"MINUTE",function(){return a}),n.d(t,"HOUR",function(){return r}),n.d(t,"DAY",function(){return c}),n.d(t,"WEEK",function(){return s}),n.d(t,"MONTH",function(){return d}),n.d(t,"EVENTS",function(){return l});var i=1,o=1e3*i,a=60*o,r=60*a,c=24*r,s=7*c,d=30*c,l={MOUSE_DOWN:"mousedown",KEY_DOWN:"keydown",SCROLL:"scroll",CLICK:"click"}},521:function(e,t,n){"use strict";function i(e){function t(){var e=geByClass1(b),t=null;switch(o()){case f.REQUEST_TEXT_FILTER:t=Object(_.createModule)({handlers:function(t,n){n(e,v.EVENTS.CLICK,y.SAVE_TEXT_BUTTON,u)}});break;case f.COUNTRY_REQUESTS_BAN:t=Object(_.createModule)({handlers:function(t,n){n(e,v.EVENTS.CLICK,L,function(e){return g(e.target)})}});break;case f.BIG_CITIES:default:t=Object(_.createModule)({handlers:function(t,n){n(e,v.EVENTS.CLICK,M,function(e){return c(e.target)}),n(e,v.EVENTS.CLICK,C,function(e){return s(e.target)}),n(e,v.EVENTS.CLICK,B,function(e){return l(e.target)}),n(e,v.EVENTS.CLICK,x,function(e){return d(e.target)}),n(e,v.EVENTS.CLICK,E,function(e){return r(e.target)}),n(e,v.EVENTS.CLICK,L,function(e){return a(e.target)})}})}cur.destroy.push(function(){Object(_.destroyModule)(t)})}cur.initOptions=e,debugLog("options: ",e),t()}function o(){return Object(m.getUrlParam)("setting")||f.BIG_CITIES}function a(e){if(!hasClass(e,L)&&!hasClass(e,S))return!1;var t=hasClass(e,L)?e:gpeByClass(L,e);toggleClass(t,"opened");var n=geByClass1(w,t);return toggle(n),!0}function r(e){var t=gpeByClass(T,e),n=gpeByClass(L,t),i=domData(t,"city-id"),o=domData(n,"country-id");if(!i||!o)return showDoneBox("Something went wrong"),!1;var a=geByClass1(M,n);return ajax.post(p,{act:h.REMOVE_BIG_CITY,country_id:o,city_id:i},{onDone:function(){re(t)},onFail:function(e){return showDoneBox(e),!0},showProgress:lockButton.pbind(a),hideProgress:unlockButton.pbind(a)}),!0}function c(e){var t=gpeByClass(L,e),n=domData(t,"country-id");if(!t||!n)return showDoneBox("Something went wrong"),!1;cur.newCitySelect&&l();var i=geByClass1(D,t);return hide(e),show(i),cur.newCitySelect=new CitySelect(geByClass1(k,t),t,{width:421,country:n}),!0}function s(e){var t=gpeByClass(L,e),n=cur.newCitySelect.val(),i=domData(t,"country-id");if(!n||!i)return showDoneBox("Something went wrong"),!1;var o=geByClass1(M,t);return ajax.post(p,{act:h.ADD_BIG_CITY,country_id:i,city_id:n},{onDone:function(e){l(),o.outerHTML=e+o.outerHTML},onFail:function(e){return showDoneBox(e),!0},showProgress:lockButton.pbind(o),hideProgress:unlockButton.pbind(o)}),!0}function d(e){var t=gpeByClass(T,e),n=gpeByClass(L,e),i=domData(t,"city-id"),o=domData(n,"country-id");if(!i||!o)return showDoneBox("Something went wrong"),!1;var a=geByClass1(M,n);return ajax.post(p,{act:h.TOGGLE_BIG_CITY_BOLD,country_id:o,city_id:i},{onDone:function(e){t.outerHTML=e},onFail:function(e){return showDoneBox(e),!0},showProgress:lockButton.pbind(a),hideProgress:unlockButton.pbind(a)}),!0}function l(){var e=gpeByClass(L,cur.newCitySelect.container),t=geByClass1(D,e),n=geByClass1(M,e);show(n),hide(t);var i=domPN(cur.newCitySelect.container);i.innerHTML='<div class="city_select"></div>',cur.newCitySelect=null}function g(e){if(!hasClass(e,L)&&!hasClass(e,S))return!1;var t=hasClass(e,L)?e:gpeByClass(L,e);hasClass(e,L)||(t=gpeByClass(L,t));var n=!hasClass(t,y.BANNED),i={act:n?h.BAN_COUNTRY_REQUESTS:h.UNBAN_COUNTRY_REQUESTS,country_id:domData(t,"country-id")};ajax.post(p,i,{onDone:function(){toggleClass(t,y.BANNED)},showProgress:function(){var e=geByClass1(y.LOADER,t);removeClass(e,y.LOADER_HIDDEN)},hideProgress:function(){var e=geByClass1(y.LOADER,t);addClass(e,y.LOADER_HIDDEN)}})}function u(){var e=geByClass1(y.SAVE_TEXT_BUTTON),t={act:h.SAVE_REQUESTS_TEXT_FILTER,words:geByClass1(y.WORDS_INPUT).value};ajax.post(p,t,{onDone:showDoneBox.pbind("Фильтр обновлен"),showProgress:lockButton.pbind(e),hideProgress:unlockButton.pbind(e)})}n.r(t),n.d(t,"init",function(){return i});var _=n(39),m=n(196),v=n(502),p="geodb.php",h={ADD_BIG_CITY:"add_big_city",REMOVE_BIG_CITY:"remove_big_city",TOGGLE_BIG_CITY_BOLD:"toggle_big_city_bold",BAN_COUNTRY_REQUESTS:"ban_country_requests",UNBAN_COUNTRY_REQUESTS:"unban_country_requests",SAVE_REQUESTS_TEXT_FILTER:"save_requests_text_filter"},f={BIG_CITIES:"big_cities",COUNTRY_REQUESTS_BAN:"country_requests_ban",REQUEST_TEXT_FILTER:"request_text_filter"},y={BANNED:"banned",LOADER:"loader_icon",LOADER_HIDDEN:"not_shown",SAVE_TEXT_BUTTON:"save_button",WORDS_INPUT:"words_input"},b="geodb_page",L="geodb_row",w="short_cities",E="_remove_short_city",C="_accept_icon",x="bold_icon",B="_cancel_addition",T="country_short_city",M="add_new_button",S="settings_country_link",k="city_select",D="hidden_select";cur.newCitySelect=null},56:function(__webpack_module__,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Edit",function(){return Edit});var Edit={progressLine:'<div style="padding:18px 0px 19px 0px;text-align: center"><img valign="middle" src="/images/progress7.gif"></div>',checkSrc:"data:image/gif,GIF89a%10%00%10%00%91%00%00%DE%E6%EF%84%9C%B5%00%00%00%00%00%00%21%F9%04%09%00%00%02%00%2C%00%00%00%00%10%00%10%00%00%08D%00%05%08%1CH%B0%A0%C1%83%02%02%204%18%40%E1%C2%81%0D%1D%3E%8C%28%11%21E%00%04%2B%26%8C%08%00%23D%89%17%3D%7ET%18%92%21%C5%86%1D%0F%028%99R%E5J%94%22%5D%06h%F9%B0c%CC%9A%0Fs%16%0C%08%00",initPageItems:function(){cur.filteredItems=cur.pageItems||[];for(var e in cur.pageItems){var t=ge(cur.pageItems[e]);addEvent(t,"mousemove",function(e){e.ctrlKey&&Edit.selectItem(e.target.id,!0),e.shiftKey&&Edit.selectItem(e.target.id,!1)})}},deinitPageItems:function(){for(var e in cur.pageItems){var t=ge(cur.pageItems[e]);removeEvent(t,"mousemove")}},d2h:function(e){return e.toString(16)},h2d:function(e){return parseInt(e,16)},countRealLen:function(e,t){for(var n={"&":5,",":5,"<":4,">":4,'"':6,"\\n":t?1:4,"\\r":0,"!":5,"'":5,$:6,"\\\\":6},i={1168:1,1169:1,8211:1,8212:1,8216:1,8217:1,8218:1,8230:1,8240:1,8249:1,8250:1,8364:1,8470:1,8482:1,65533:1},o={1037:1,1104:1,1117:1},a=0,r=0,c=e.length;c>r;r++){var s=n[e.charAt(r)],d=e.charCodeAt(r);a+=void 0!==s?s:d>=128&&(1025>d||o[d]||d>1119)&&!i[d]&&(8220>d||d>8222)&&(8224>d||d>8226)?("&#"+d+";").length:1}return a},showAutoCorrect:function(e){each(ge("auxFuncs").children,function(e,t){t.style&&!hasClass(t,"ed_autocorr_block")&&toggle(t)}),show("autoCorrectLink"),ajax.post("/editdb",{act:"a_get_autocorrections",section:e},{onDone:Edit.getAutoCorrectionsSuccess}),ge("autoCorrections").innerHTML=Edit.progressLine},getAutoCorrectionsSuccess:function(e,t,n){Edit.loadAutocorrects(e),ge("autoCorrections").innerHTML=t,n&&(ge("autocorrNum").innerHTML=n,ge("autocorr_num")&&(ge("autocorr_num").value=n))},removeAutoCorrection:function(e,t){ajax.post("/editdb",{act:"a_remove_autocorrection",cid:e,section:t},{onDone:Edit.getAutoCorrectionsSuccess}),ge("autoCorrections").innerHTML=Edit.progressLine},addAutoCorrection:function(e){var t=val("addCorrectionFrom"),n=val("addCorrectionTo");t?(ajax.post("/editdb",{act:"a_add_autocorrection",section:e,from:t,to:n},{onDone:Edit.getAutoCorrectionsSuccess}),ge("autoCorrections").innerHTML=Edit.progressLine):notaBene("addCorrectionFrom")},updateObjectTime:function(e,t){ajax.post("editdb",{act:"a_update_time",obj_id:e,obj_type:t,hash:val("object_time_"+t+"_"+e+"_hash")},{onDone:function(n){ge("edit_time_link_"+t+"_"+e).innerHTML=n}})},addObjComment:function(e,t){var n="editdb",i={act:"a_add_comment",obj_id:e,obj_type:t},o=showBox(n,i,{onDone:function(){elfocus("obj_comment_"+t+"_"+e)}});o.removeButtons(),o.addButton(getLang("global_close"),null,"no");var a=function(a){i.comment=val("obj_comment_"+t+"_"+e),i.do_add=1,i.hash=val("obj_comment_"+t+"_"+e+"_hash"),ajax.post(n,i,{showProgress:lockButton.pbind(a),hideProgress:unlockButton.pbind(a),onDone:function(n){ge("edit_add_comment_link_"+t+"_"+e).innerHTML=getLang("edit_add_comment_link")+(n?"":" +1"),o.hide()}})},r=o.addButton(getLang("global_save"),a,"",!0);cur.addObjCommentBtnFunc=function(){a(r)}},loadAutocorrects:function(e){ajax.post("/editdb",{act:"a_autocorrection_list",section:e},{onDone:function(t){cur.autoCorrectCache[e]={loaded:1,corrections:t}}})},autoCorrect:function(e,t){Edit.doAutoCorrect(t?t:"name",cur.autoCorrectCache[e]?cur.autoCorrectCache[e].corrections:{})},autoCorrectMul:function(e,t){for(var n=Edit.getSelectedItems(t),i=0;i<n.length;++i){var o=parseInt(n[i]);Edit.autoCorrect(e,"name"+o)}},doAutoCorrect:function doAutoCorrect(inp,corrections){if(corrections){var input=inp?ge(inp):ge("name");if(input){for(var lines=val(input).split("\n"),i=0;i<corrections.length;i++){var correction=corrections[i],from=correction.from.replace(/&#092;/g,"\\");matches=from.match(/&#\d+;/g);var replacements=[];if(matches)for(var j=0;j<matches.length;j++){var num=parseInt(matches[j].substring(2,matches[j].length-1));if(2==Edit.d2h(num).length)var mid="0";else var mid="";replacements[j]={num:num,repl:eval("'\\u0"+mid+Edit.d2h(num)+"'")}}for(var j=0;j<replacements.length;j++)from=from.replace("&#"+replacements[j].num.toString(10)+";",replacements[j].repl);from=from.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/,"&");var replaceTo=correction.to,matches=replaceTo.match(/&#\d+;/g);if(replacements=[],matches)for(var j=0;j<matches.length;j++){var num=parseInt(matches[j].substring(2,matches[j].length-1));mid=2==Edit.d2h(num).length?"0":"",replacements[j]={num:num,repl:eval("'\\u0"+mid+Edit.d2h(num)+"'")}}for(var j=0;j<replacements.length;j++)replaceTo=replaceTo.replace("&#"+replacements[j].num.toString(10)+";",replacements[j].repl);replaceTo=replaceTo.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/,"&");try{for(var replaceFrom=new RegExp(from,"g"),j=0;j<lines.length;j++)lines[j]=lines[j].replace(replaceFrom,replaceTo)}catch(e){}}val(input,lines.join("\n")),input.scrollTop=input.scrollHeight}}},replaceText:function(e){e||(e="name");var t=e.split(",");for(var n in t)if(e=t[n],e=ge(e)){var i=e.value,o=[];o=i.split("\n");for(var n=0;n<o.length;n++){var a=new RegExp(ge("replaceFrom").value,"g");o[n]=o[n].replace(a,ge("replaceTo").value)}var r=o.join("\n");e.value=r,e.scrollTop=e.scrollHeight}},replaceTextMul:function(e){for(var t=Edit.getSelectedItems(e),n=0;n<t.length;++n){var i=parseInt(t[n]);Edit.replaceText("name"+i)}},translit:function(e){if(e=ge(e)){for(var t,n=e.value,i=n,o=["yo","zh","h","ts","ch","sch","sch","sh","e","yu","ya","Yo","Zh","H","Ts","Ch","Sch","Sch","Sh","E","Yu","Ya","'"],a=["ё","ж","х","ц","ч","щ","щ","ш","э","ю","я","Ё","Ж","Х","Ц","Ч","Щ","Щ","Ш","Э","Ю","Я","ь"],t=0;t<a.length;t++)i=i.split(a[t]).join(o[t]);for(var r="abvgdeziyklmnoprstufhcyABVGDEZIJKLMNOPRSTUFHCYёЁ",c="абвгдезийклмнопрстуфхцыАБВГДЕЗИЙКЛМНОПРСТУФХЦЫеЕ",t=0;t<c.length;t++)i=i.split(c.charAt(t)).join(r.charAt(t));e.value=i}},translitMul:function(e,t){for(var n=Edit.getSelectedItems(t),i=0;i<n.length;++i){var o=parseInt(n[i]);Edit.translit("name"+o)}},convertCaseAa:function(e,t){if(!t)return topError("No input to convert specified",{dt:6}),!1;var n=t.split(",");for(var i in n)if(t=n[i],t=ge(t)){for(var o=val(t).split("\n"),a=[],r=0;r<o.length;r++){var c=o[r];if(c){var s=c.substring(0,1).toUpperCase(),d=c.substring(1);a.push(s+d)}}t.value=a.join("\n")+"\n",t.scrollTop=t.scrollHeight,Edit.autoCorrect(e,t)}},convertCaseAaMul:function(e,t){for(var n=Edit.getSelectedItems(t),i=0;i<n.length;++i){var o=parseInt(n[i]);Edit.convertCaseAa(e,"name"+o),Edit.convertCaseAa(e,"native_name"+o)}},convertCaseAaBb:function(e,t){if(!t)return topError("No input to convert specified",{dt:6}),!1;var n=t.split(",");for(var i in n){t=ge(n[i]);for(var o=val(t).split("\n"),a=[],r=0;r<o.length;r++){var c=o[r];if(c){for(var s="",d=0;d<c.length;++d){for(var l=" ",g=d-1;g>=0&&(l=c[g],"("==l||'"'==l);--g);s+=" "==l||"."==l||'"'==l||"("==l?c[d].toUpperCase():c[d].toLowerCase()}a.push(s)}}t.value=a.join("\n")+"\n",t.scrollTop=t.scrollHeight,Edit.autoCorrect(e,t)}},convertCaseAaBbMul:function(e,t){for(var n=Edit.getSelectedItems(t),i=0;i<n.length;++i){var o=parseInt(n[i]);Edit.convertCaseAaBb(e,"name"+o),Edit.convertCaseAaBb(e,"native_name"+o)}},convertCaseAabb:function(e,t){if(!t)return topError("No input to convert specified",{dt:6}),!1;var n=t.split(",");for(var i in n)if(t=n[i],t=ge(t)){for(var o=val(t).split("\n"),a=[],r=0;r<o.length;r++){var c=o[r];if(c){var s=c.substring(0,1);s=s.toUpperCase();var d=c.substring(1).toLowerCase();a.push(s+d)}}t.value=a.join("\n")+"\n",t.scrollTop=t.scrollHeight,Edit.autoCorrect(e,t)}},convertCaseAabbMul:function(e,t){for(var n=Edit.getSelectedItems(t),i=0;i<n.length;++i){var o=parseInt(n[i]);Edit.convertCaseAabb(e,"name"+o),Edit.convertCaseAabb(e,"native_name"+o)}},genCorrectionControls_:function(e,t,n,i,o,a,r,c){var s='<div style="padding: 5px 2px;"><b>'+getLang("edit_case_word")+'</b></div><div>  <div class="flat_button secondary" onclick="'+t+'">'+getLang("edit_some_words1")+'</div>  <div class="flat_button secondary" onclick="'+n+'">'+getLang("edit_some_words2")+'</div>  <div class="flat_button secondary"  onclick="'+i+'">'+getLang("edit_some_words3")+'</div></div><div style="padding: 5px 2px;"><b>'+getLang("edit_replacement")+"</b></div><div style=\"padding: 5px 0;\">  <input id='replaceFrom' type='text' style='width:80px;' class='text dark' value='' placeholder='"+getLang("edit_replacement_what")+"'/> &rarr; <input id='replaceTo' type='text' style='width:80px;' class='text dark' value='' placeholder='"+getLang("edit_replacement_by")+'\' />  <div class="flat_button secondary" onclick="'+o+'">'+getLang("edit_replace")+'</div></div><div id="autoCorrectLink" style="padding: 5px 2px;" class="ed_autocorr_block"><a onclick=\''+a+"'><b>"+getLang("edit_autoreplacements")+' (<span id="autocorrNum">'+e+"</span>)</b></a></div>"+c+'<div id="autoCorrections" style="padding: 5px 7px; display: none;">'+getLang("edit_autoreplacements_list")+"</div>";return s+="<div style=\"padding: 5px 2px; border-style: none none none; display: none;\"><table cellpadding=5><tbody><tr><td><input id='addCorrectionFrom' type='text' style='width:180px;' value=''></td><td> &gt;&gt; </td><td><input id='addCorrectionTo' type='text' style='width:80px;' value=''></td><td><a href='javascript:"+r+"'>"+getLang("edit_add")+"</a></td>",s+="</tr></tbody></table></div>"},genCorrectionControls:function(e,t,n){var i='<div class="flat_button secondary" onclick="Edit.autoCorrect('+e+", "+t+');">'+getLang("edit_do_autoreplace")+"</div>";return i+=' <div class="flat_button secondary" onclick="Edit.translit('+t+');">Translit</div>',Edit.genCorrectionControls_(n,"Edit.convertCaseAa("+e+", '"+t+"')","Edit.convertCaseAaBb("+e+", '"+t+"')","Edit.convertCaseAabb("+e+", '"+t+"')","Edit.replaceText('"+t+"')","Edit.showAutoCorrect("+e+")","Edit.addAutoCorrection("+e+")","<div>"+i+"</div>")},genCorrectionControlsMul:function(e,t,n){var i='<div class="flat_button secondary" onclick="Edit.autoCorrectMul('+e+", "+t+');">'+getLang("edit_do_autoreplace")+"</div>";return i+=' <div class="flat_button secondary" onclick="Edit.translitMul('+e+", "+t+')">Translit</div>',Edit.genCorrectionControls_(n,"Edit.convertCaseAaMul("+e+", "+t+")","Edit.convertCaseAaBbMul("+e+", "+t+")","Edit.convertCaseAabbMul("+e+", "+t+")","Edit.replaceTextMul("+t+")","Edit.showAutoCorrect("+e+")","Edit.addAutoCorrection("+e+")","<div>"+i+"</div>")},getDefaultListParams:function(e,t){return{defaultItems:t,selectedItems:e,introText:"",maxItems:2e4,showMax:200,width:400,height:250,dropdown:!0}},getSelectedItems:function(e){var t=[];for(var n in cur.selected)cur.selected[n]&&t.push([parseInt(n.toString().replace(/[^\d]*/,"")),e(cur.selected[n])]);return t},getAllItems:function(e){var t=[];for(var n in cur.pageItems){var i=cur.pageItems[n];ge(i)&&t.push([parseInt(i.toString().replace(/[^\d]*/,"")),e(ge(i))])}return t},getIdList:function(e){var t=[];for(var n in e)t.push(e[n][0]);return t.join(",")},selectItem:function(e,t){var n=cur.filteredItems,i=0;if("all"==e){for(var o in n){var e=n[o],a=ge("check_"+e);if(checkbox(a,!cur.selectedAll),cur.selectedAll)cur.selected[e]=void 0;else{++i;var r=ge(e);cur.selected[e]=r}}cur.selectedAll=!cur.selectedAll}else{var r=ge(e),c=ge("check_"+e);if(!r||!c)return;var s=cur.selected[e];void 0!==t&&(s=!t),checkbox(c,!s),s?cur.selected[e]=void 0:(r=ge(e),cur.selected[e]=r),cur.selectedAll=!0;for(var o in n)"length"!=o&&(void 0==cur.selected[n[o]]?cur.selectedAll=!1:++i)}each(geByClass("checkboxall"),function(e,t){checkbox(t,cur.selectedAll)}),val("select_counter",i?getLang("edit_selected_objects",i,!1):"");var d=ge("ed_head_title");addClass(d,"page_block_header_refresh"),removeClass(d,"page_block_header_refresh")},getMessageBox:function(e,t,n,i,o,a){var r=new MessageBox({title:e,width:t}),c=function(e){("enter"==a&&e.keyCode==KEY.RETURN||"ctrl-enter"==a&&e.keyCode==KEY.RETURN&&e.ctrlKey)&&(s(),cancelEvent(e))},s=function(){o(),a&&removeEvent(window,"keydown",c)},d=function(){r.hide(),a&&removeEvent(window,"keydown",c)};return r.removeButtons(),r.addButton(i,d,"no"),r.addButton(n,s),a&&addEvent(window,"keydown",c),r},hideBox:function(){var e=curBox();e&&e.hide()},onEnter:function(e,t){e&&e.keyCode==KEY.ENTER&&t&&t()},addMessageBoxButtons:function(e,t,n){return e.removeButtons(),e.addButton(getLang("global_cancel"),null,"no"),e.addButton(t,n,"ok",!0)},processSearchForm:function(e){var t=ge(e),n=geByTag("input",t),i={0:nav.objLoc[0]};each(n,function(e,t){i[attr(t,"name")]=val(t)}),addClass(domPN(t),"ed_obj_search_loading"),nav.go(i)}}},629:function(e,t,n){"use strict";n.r(t),n.d(t,"StationEdit",function(){return i});var i={progressLine:'<div style="padding:18px 0px 19px 0px;text-align: center"><img valign="middle" src="/images/progress7.gif"></div>',
opFailed:function(e){ge("station"+e).getElementsByTagName("div")[0].innerHTML=getLang("global_unknown_error")},showCreateStationBox:function(e,t){var n=new MessageBox({title:getLang("edit_addingstations"),width:500}),i='<div id="auxFuncs">';i+="<div id=\"inputDiv\"><table cellpadding=0><tr><td valign=top><div style='padding:5px 0px;'><div style='padding:5px 0px;'><b>"+getLang("edit_station_name")+"</b></div> <textarea onKeyPress='onCtrlEnter(event, cur.onSaveClick);' onchange='Edit.autoCorrect(5);' style='width:352px;height:200px;' id='name'></textarea><div id='create_station_msg'></div></td></tr></table></div>",i+=Edit.genCorrectionControls(5,"name",t),i+="</div>",n.content(i),Edit.loadAutocorrects(5),cur.onSaveClick=function(){var t=ge("name").value,i=Edit.countRealLen(t,!0);hide("create_station_msg"),i>9e3?(ge("create_station_msg").innerHTML=getLang("text_exceeds_symbol_limit",i-9e3),show("create_station_msg")):t.length>0?(ge("addActHidden").value="doCreateStation",ge("addNameHidden").value=t,ge("addCityHidden").value=e,ge("addFormHidden").submit(),n.showProgress()):notaBene("name")},n.addButton(getLang("global_cancel"),null,"no"),n.addButton(getLang("edit_add"),cur.onSaveClick),n.show(),elfocus("name")},setMergeObject:function(e){cur.mergeObject>0&&(ge("station"+cur.mergeObject).style.backgroundColor="#FFFFFF",ge("name_station"+cur.mergeObject).style.color="#2B587A",ge("msg_station"+cur.mergeObject).innerHTML=""),e!=cur.mergeObject?(ge("station"+e).style.backgroundColor="#E2E8ED",ge("name_station"+e).style.color="#36638E",ge("msg_station"+e).innerHTML="<div class='report'>"+getLang("edit_station_youselected")+"</div>",cur.mergeObject=e):cur.mergeObject=0},mergeStation:function(e,t){cur.mergeObject?t?ajax.post("/editdb",{act:"a_merge_station",station:e,main_station:cur.mergeObject},{showProgress:lockButton.pbind(t),hideProgress:function(){unlockButton(t),Edit.hideBox()},onDone:function(t,n){ge("actions_station"+e).innerHTML="",ge("msg_station"+e).innerHTML=n,2==t&&setTimeout(function(){ge("station"+e).style.opacity=.3},1e3)},onFail:i.opFailed.pbind(e)}):i.showMergeStationBox(e):ge("msg_station"+e).innerHTML="<div class='reportGrey'>"+getLang("edit_station_youshould")+"</div>"},showMergeStationBox:function(e){var t=new MessageBox({title:getLang("global_action_confirmation")});t.content(getLang("edit_city_suremerge").replace(/%s|{city1}/,ge("name_station"+e).innerHTML).replace(/%s|{city2}/,ge("name_station"+cur.mergeObject).innerHTML));var n;cur.onSaveClick=function(){i.mergeStation(e,n),removeEvent(window,"keydown")},addEvent(window,"keydown",function(e){Edit.onEnter(e,cur.onSaveClick)}),t.addButton(getLang("global_cancel"),function(){removeEvent(window,"keydown"),t.hide()},"no"),n=t.addButton(getLang("edit_merge"),cur.onSaveClick,"",!0),t.show()},showEditStationBox:function(e){var t=new MessageBox({title:ge("station"+e).getElementsByTagName("a")[0].innerHTML});t.content("<table cellpadding=0><tr><td valign=top><div style='padding:5px 0px;'><b>"+getLang("edit_station_name")+"</b></div> <input type='text' style='width: 352px' onKeyPress='Edit.onEnter(event, cur.onSaveClick);' id='name"+e+"' value='"+ge("station"+e).getElementsByTagName("b")[0].innerHTML.replace(/'/g,"&#39;")+"'> </td></tr></table>");var n;cur.onSaveClick=function(){if(ge("name"+e).value.length>0){var t=ge("name"+e).value;ajax.post("/editdb",{act:"a_edit_station",station:e,name:t},{showProgress:lockButton.pbind(n),hideProgress:unlockButton.pbind(n),onDone:function(n){Edit.hideBox(),ge("msg_station"+e).innerHTML=n,ge("station"+e).getElementsByTagName("b")[0].innerHTML=t},onFail:i.opFailed.pbind(e)})}else notaBene("name"+e)},t.addButton(getLang("global_cancel"),null,"no"),n=t.addButton(getLang("edit_editsave"),cur.onSaveClick,"",!0),t.show(),elfocus("name"+e,0)},stationDelSuccess:function(e,t,n){1==t?i.showDelStationBox(e,n):(2==t&&Edit.hideBox(),ge("msg_station"+e).innerHTML=n,ge("station"+e).getElementsByTagName("span")[0].style.display="none",setTimeout(function(){ge("station"+e).style.opacity=.3},1e3))},showDelStationBox:function(e,t){var n=new MessageBox({title:ge("station"+e).getElementsByTagName("b")[0].innerHTML});n.content(getLang("edit_station_suredelete")+t),addEvent(window,"keydown",function(e){Edit.onEnter(e,cur.onDelClick)});var o;return cur.onDelClick=function(){ajax.post("/editdb",{act:"a_real_del_station",station:e},{showProgress:lockButton.pbind(o),hideProgress:unlockButton.pbind(o),onDone:i.stationDelSuccess.pbind(e),onFail:i.opFailed.pbind(e)}),removeEvent(window,"keydown")},n.addButton(getLang("global_cancel"),null,"no"),o=n.addButton(getLang("global_delete"),cur.onDelClick,"",!0),n.show(),ge("del"+e+"link").blur(),!1},deleteStation:function(e){ajax.post("/editdb",{act:"a_del_station",station:e},{onDone:i.stationDelSuccess.pbind(e),onFail:i.opFailed.pbind(e)})},restoreStation:function(e){ajax.post("/editdb",{act:"a_restore_station",station:e},{onDone:function(t,n){t&&(ge("msg_station"+e).innerHTML=n,ge("station"+e).getElementsByTagName("span")[0].style.display="inline",setTimeout(function(){ge("station"+e).style.opacity=1},1e3))},onFail:i.opFailed.pbind(e)})},countStation:function(e){ajax.post("/editdb",{act:"a_count_station",station:e},{onDone:function(t){ge("msg_station"+e).innerHTML=t},onFail:i.opFailed.pbind(e)}),ge("msg_station"+e).innerHTML=i.progressLine}}}});